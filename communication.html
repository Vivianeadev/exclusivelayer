<!-- Communication Tab -->
      <div class="tab-content" id="communicationTab">
        <div class="wallet-header">
          <h2><i class="fas fa-comments"></i> Sistema de Comunicação Premium</h2>
          <p>Comunicação criptografada ponto-a-ponto via Polygon Network</p>
        </div>

        <!-- Sub-navegação da aba de comunicação -->
        <div class="sub-tab-navigation">
          <button class="sub-tab-btn active" data-subtab="authTab">
            <i class="fas fa-key"></i> Autorização
          </button>
          <button class="sub-tab-btn" data-subtab="contactsTab">
            <i class="fas fa-users"></i> Contatos
          </button>
          <button class="sub-tab-btn" data-subtab="chatTab">
            <i class="fas fa-comment"></i> Chat Privado
          </button>
          <button class="sub-tab-btn" data-subtab="videoTab">
            <i class="fas fa-video"></i> Vídeo Chamada
          </button>
          <button class="sub-tab-btn" data-subtab="groupTab">
            <i class="fas fa-comments"></i> Grupos
          </button>
          <button class="sub-tab-btn" data-subtab="groupVideoTab">
            <i class="fas fa-video"></i> Vídeo em Grupo
          </button>
        </div>

        <!-- Sub-aba: Autorização -->
        <div class="sub-tab-content" id="authTab">
          <div class="authorization-box">
            <h3 class="address-registration-title">
              <i class="fas fa-user-shield"></i> Autorização de Acesso
            </h3>
            
            <p class="address-instruction">
              Para acessar o sistema de comunicação, você precisa autorizar seu endereço Polygon.
              Esta autorização garante que apenas você pode usar seus recursos de comunicação.
            </p>
            
            <div class="input-group">
              <label for="authWalletAddress">Seu Endereço Polygon para Autorização</label>
              <input type="text" id="authWalletAddress" placeholder="0x..." style="font-family: 'Courier New', monospace;">
            </div>
            
            <div class="verification-status">
              <div class="status-indicator" id="authStatusIndicator" style="background: var(--text-secondary);"></div>
              <span id="authStatusText" style="color: var(--text-secondary); font-size: 13px;">Não autorizado</span>
            </div>
            
            <button class="btn btn-primary" onclick="authorizeChatAccess()">
              <i class="fas fa-check"></i> Autorizar Acesso
            </button>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--card-border);">
              <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.5;">
                <i class="fas fa-info-circle"></i> A autorização vincula seu endereço Polygon ao sistema de comunicação.
                Você pode adicionar contatos, iniciar chats e chamadas de vídeo apenas com endereços autorizados.
              </p>
            </div>
          </div>
        </div>

        <!-- Sub-aba: Contatos -->
        <div class="sub-tab-content hidden" id="contactsTab">
          <div class="communication-main-container">
            <h3 class="address-registration-title">
              <i class="fas fa-address-book"></i> Gerenciamento de Contatos
            </h3>
            
            <p class="address-instruction">
              Gerencie seus contatos Polygon para comunicação rápida e segura.
            </p>
            
            <!-- Lista de contatos -->
            <div class="contacts-list-container" id="contactsList">
              <!-- Contatos serão carregados aqui -->
            </div>
            
            <!-- Formulário para adicionar novo contato -->
            <div class="add-contact-form">
              <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                <i class="fas fa-user-plus"></i> Adicionar Novo Contato
              </h4>
              
              <div class="input-group">
                <label for="newContactName">Nome do Contato</label>
                <input type="text" id="newContactName" placeholder="Ex: João Silva">
              </div>
              
              <div class="input-group">
                <label for="newContactAddress">Endereço Polygon do Contato</label>
                <input type="text" id="newContactAddress" placeholder="0x..." style="font-family: 'Courier New', monospace;">
              </div>
              
              <button class="btn btn-primary" onclick="addNewContact()">
                <i class="fas fa-plus"></i> Adicionar Contato
              </button>
            </div>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--card-border);">
              <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.5;">
                <i class="fas fa-shield-alt"></i> Seus contatos são armazenados localmente e criptografados.
                Apenas você tem acesso à sua lista de contatos.
              </p>
            </div>
          </div>
        </div>

        <!-- Sub-aba: Chat Privado -->
        <div class="sub-tab-content hidden" id="chatTab">
          <div class="communication-main-container">
            <h3 class="address-registration-title">
              <i class="fas fa-comment-dots"></i> Chat Privado Criptografado
            </h3>
            
            <p class="address-instruction">
              Conversas privadas ponto-a-ponto criptografadas com tecnologia de ponta.
            </p>
            
            <!-- Seletor de contato para chat -->
            <div class="input-group">
              <label for="selectChatContact">Selecionar Contato para Conversar</label>
              <select id="selectChatContact" style="padding: 18px 15px;">
                <option value="">Selecione um contato</option>
              </select>
            </div>
            
            <!-- Área do chat -->
            <div class="chat-container">
              <div class="chat-messages" id="privateChatMessages">
                <div class="message message-received">
                  <div class="message-sender">Sistema</div>
                  <div>Selecione um contato para iniciar uma conversa privada.</div>
                  <div class="message-time">Agora</div>
                </div>
              </div>
              
              <div class="chat-input-area">
                <input type="text" class="chat-input" id="privateChatInput" placeholder="Digite sua mensagem..." 
                       onkeypress="handlePrivateChatKeyPress(event)" disabled>
                <button class="btn btn-primary btn-small" onclick="sendPrivateMessage()" disabled>
                  <i class="fas fa-paper-plane"></i>
                </button>
              </div>
            </div>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--card-border);">
              <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.5;">
                <i class="fas fa-lock"></i> Todas as mensagens são criptografadas ponto-a-ponto.
                Nem mesmo o servidor pode ler o conteúdo das suas conversas.
              </p>
            </div>
          </div>
        </div>

        <!-- Sub-aba: Vídeo Chamada -->
        <div class="sub-tab-content hidden" id="videoTab">
          <div class="communication-main-container">
            <h3 class="address-registration-title">
              <i class="fas fa-video"></i> Chamada de Vídeo Segura
            </h3>
            
            <p class="address-instruction">
              Chamadas de vídeo criptografadas com qualidade premium via WebRTC.
            </p>
            
            <!-- Seletor de contato para vídeo -->
            <div class="input-group">
              <label for="selectVideoContact">Selecionar Contato para Vídeo Chamada</label>
              <select id="selectVideoContact" style="padding: 18px 15px;">
                <option value="">Selecione um contato</option>
              </select>
            </div>
            
            <!-- Área do vídeo -->
            <div class="video-container" id="videoCallContainer">
              <div class="video-placeholder">
                <i class="fas fa-video"></i>
                <div>Chamada de vídeo não iniciada</div>
                <div style="font-size: 12px; margin-top: 10px;">Selecione um contato e clique em "Iniciar Vídeo"</div>
              </div>
            </div>
            
            <!-- Controles de vídeo -->
            <div class="video-controls">
              <button class="btn btn-primary btn-small" id="startVideoBtn" onclick="startVideoCall()">
                <i class="fas fa-video"></i> Iniciar Vídeo
              </button>
              <button class="btn btn-secondary btn-small" id="endVideoBtn" onclick="endVideoCall()" disabled>
                <i class="fas fa-phone-slash"></i> Encerrar
              </button>
              <button class="btn btn-secondary btn-small" id="toggleVideoBtn" onclick="toggleVideo()" disabled>
                <i class="fas fa-video-slash"></i> Desligar Vídeo
              </button>
              <button class="btn btn-secondary btn-small" id="toggleAudioBtn" onclick="toggleAudio()" disabled>
                <i class="fas fa-microphone-slash"></i> Silenciar
              </button>
            </div>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--card-border);">
              <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.5;">
                <i class="fas fa-shield-alt"></i> Sua chamada de vídeo é criptografada de ponta a ponta.
                A conexão é direta entre os participantes, sem servidores intermediários.
              </p>
            </div>
          </div>
        </div>

        <!-- Sub-aba: Grupos -->
        <div class="sub-tab-content hidden" id="groupTab">
          <div class="communication-main-container">
            <h3 class="address-registration-title">
              <i class="fas fa-users"></i> Grupos de Comunicação
            </h3>
            
            <p class="address-instruction">
              Crie e participe de grupos de chat para comunicação em comunidade.
            </p>
            
            <!-- Criar novo grupo -->
            <div class="add-contact-form" style="margin-bottom: 30px;">
              <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                <i class="fas fa-plus-circle"></i> Criar Novo Grupo
              </h4>
              
              <div class="input-group">
                <label for="groupName">Nome do Grupo</label>
                <input type="text" id="groupName" placeholder="Ex: Time de Desenvolvimento">
              </div>
              
              <button class="btn btn-primary" onclick="createNewGroup()">
                <i class="fas fa-plus"></i> Criar Grupo
              </button>
            </div>
            
            <!-- Lista de grupos disponíveis -->
            <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
              <i class="fas fa-list"></i> Grupos Disponíveis
            </h4>
            
            <div class="dev-agenda-grid" id="availableGroups">
              <div class="agenda-entry">
                <div class="agenda-header">
                  <div class="agenda-title">Polygon Community</div>
                  <div class="agenda-status status-in-progress">Ativo</div>
                </div>
                <div class="agenda-description">Comunidade oficial de desenvolvedores Polygon.</div>
                <div class="agenda-footer">
                  <div>128 membros</div>
                  <button class="btn btn-secondary btn-small" onclick="joinGroup('Polygon Community')" style="padding: 4px 8px; font-size: 10px;">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Chat do grupo -->
            <div style="margin-top: 30px;">
              <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                <i class="fas fa-comments"></i> Chat do Grupo
              </h4>
              
              <div class="chat-container" style="height: 300px;">
                <div class="chat-messages" id="groupChatMessages">
                  <div class="message message-received">
                    <div class="message-sender">Sistema</div>
                    <div>Entre em um grupo para começar a conversar.</div>
                    <div class="message-time">Agora</div>
                  </div>
                </div>
                
                <div class="chat-input-area">
                  <input type="text" class="chat-input" id="groupChatInput" placeholder="Digite sua mensagem para o grupo..." 
                         onkeypress="handleGroupChatKeyPress(event)">
                  <button class="btn btn-primary btn-small" onclick="sendGroupMessage()">
                    <i class="fas fa-paper-plane"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sub-aba: Vídeo em Grupo -->
        <div class="sub-tab-content hidden" id="groupVideoTab">
          <div class="communication-main-container">
            <h3 class="address-registration-title">
              <i class="fas fa-video"></i> Reuniões de Vídeo em Grupo
            </h3>
            
            <p class="address-instruction">
              Reuniões de vídeo com múltiplos participantes via tecnologia WebRTC.
            </p>
            
            <!-- Layout reestruturado -->
            <div style="display: flex; gap: 30px; margin-bottom: 30px; flex-wrap: wrap;">
              <!-- Área de controles laterais -->
              <div style="flex: 0 0 250px; display: flex; flex-direction: column; gap: 15px;">
                <div style="background: var(--gradient-card); border: 1px solid var(--card-border); border-radius: 12px; padding: 20px;">
                  <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                    <i class="fas fa-plus-circle"></i> Criar Reunião
                  </h4>
                  <div class="input-group" style="margin-bottom: 15px;">
                    <label for="groupVideoName" style="font-size: 12px;">Nome da Reunião</label>
                    <input type="text" id="groupVideoName" placeholder="Ex: Reunião de Planejamento" style="padding: 12px 15px; font-size: 13px;">
                  </div>
                  <button class="btn btn-primary btn-small" onclick="createGroupVideo()" style="width: 100%;">
                    <i class="fas fa-video"></i> Criar Reunião
                  </button>
                </div>
                
                <div style="background: var(--gradient-card); border: 1px solid var(--card-border); border-radius: 12px; padding: 20px;">
                  <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                    <i class="fas fa-sign-in-alt"></i> Entrar na Reunião
                  </h4>
                  <div class="input-group" style="margin-bottom: 15px;">
                    <label for="groupVideoCode" style="font-size: 12px;">Código da Reunião</label>
                    <input type="text" id="groupVideoCode" placeholder="Digite o código" style="padding: 12px 15px; font-size: 13px;">
                  </div>
                  <button class="btn btn-primary btn-small" onclick="joinGroupVideo()" style="width: 100%;">
                    <i class="fas fa-users"></i> Entrar na Reunião
                  </button>
                </div>
                
                <!-- Controles de vídeo em grupo (inicialmente desabilitados) -->
                <div style="background: var(--gradient-card); border: 1px solid var(--card-border); border-radius: 12px; padding: 20px; display: none;" id="groupVideoControls">
                  <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                    <i class="fas fa-sliders-h"></i> Controles
                  </h4>
                  <div class="video-controls" style="flex-direction: column; gap: 10px;">
                    <button class="btn btn-secondary btn-small" id="toggleGroupVideoBtn" onclick="toggleGroupVideo()" disabled style="width: 100%;">
                      <i class="fas fa-video-slash"></i> Desligar Vídeo
                    </button>
                    <button class="btn btn-secondary btn-small" id="toggleGroupAudioBtn" onclick="toggleGroupAudio()" disabled style="width: 100%;">
                      <i class="fas fa-microphone-slash"></i> Silenciar
                    </button>
                    <button class="btn btn-secondary btn-small" id="leaveGroupVideoBtn" onclick="leaveGroupVideo()" disabled style="width: 100%;">
                      <i class="fas fa-sign-out-alt"></i> Sair da Reunião
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Área principal de vídeo -->
              <div style="flex: 1; min-width: 300px;">
                <!-- Área do vídeo em grupo -->
                <div class="video-container" id="groupVideoContainer" style="height: 400px; margin-bottom: 20px;">
                  <div class="video-placeholder">
                    <i class="fas fa-users" style="font-size: 48px; color: var(--text-secondary);"></i>
                    <div style="font-size: 18px; margin-top: 15px;">Nenhuma reunião ativa</div>
                    <div style="font-size: 13px; margin-top: 10px; color: var(--text-secondary); max-width: 400px; line-height: 1.5;">
                      Crie uma nova reunião ou entre em uma existente usando os controles ao lado
                    </div>
                  </div>
                </div>
                
                <!-- Lista de participantes -->
                <div>
                  <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 16px;">
                    <i class="fas fa-users"></i> Participantes
                  </h4>
                  
                  <div class="contacts-list-container" id="participantsList" style="max-height: 150px;">
                    <div style="text-align: center; padding: 20px; color: var(--text-secondary);">
                      <i class="fas fa-user-friends"></i>
                      <div>Nenhum participante na reunião</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--card-border);">
              <p style="color: var(--text-secondary); font-size: 12px; line-height: 1.5;">
                <i class="fas fa-shield-alt"></i> Suas reuniões de vídeo são criptografadas de ponta a ponta.
                A conexão é direta entre os participantes, sem servidores intermediários.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
