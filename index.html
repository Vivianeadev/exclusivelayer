<!-- WALLET WEB3 PREMIUM - COM IA SOUND EXCLUSIVE FUNCIONAL -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Exclusive Layer Identity — Sistema Blockchain Isolado</title>
  
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Cinzel:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <style>
   /* CSS EXATAMENTE IGUAL - NENHUMA ALTERAÇÃO */
   :root{--gold-primary:#D4AF37;--gold-secondary:#F4E4B8;--gold-accent:#B8860B;--gold-dark:#8B6914;--platinum:#E5E4E2;--carbon:#1A1A1A;--obsidian:#0A0A0A;--emerald:#046307;--sapphire:#0F52BA;--ruby:#E0115F;--diamond:#B9F2FF;--transition:all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);--shadow-luxury:0 25px 50px rgba(0, 0, 0, 0.1),0 15px 30px rgba(0, 0, 0, 0.08);--shadow-gold:0 8px 32px rgba(212,175,55,0.25);--gradient-gold:linear-gradient(135deg,#D4AF37 0%,#F4E4B8 50%,#B8860B 100%);--gradient-dark:linear-gradient(135deg,#1A1A1A 0%,#0A0A0A 100%);--gradient-card:linear-gradient(135deg,rgba(212,175,55,0.1) 0%,rgba(244,228,184,0.05) 100%);--wet-mirror:linear-gradient(135deg,rgba(255,255,255,0.1) 0%,rgba(255,255,255,0.05) 25%,rgba(255,255,255,0.15) 50%,rgba(255,255,255,0.05) 75%,rgba(255,255,255,0.1) 100%)}.theme-luxury{--primary-color:#D4AF37;--secondary-color:#F4E4B8;--accent-color:#B8860B;--background-primary:#0A0A0A;--background-secondary:#1A1A1A;--text-primary:#F0F0F0;--text-secondary:#B0B0B0;--container-bg:rgba(26,26,26,0.95);--container-border:rgba(212,175,55,0.3);--card-bg:rgba(30,30,30,0.8);--card-border:rgba(212,175,55,0.2);--success-color:#00C853;--warning-color:#FFD700;--error-color:#FF5252}.theme-light{--primary-color:#D4AF37;--secondary-color:#F4E4B8;--accent-color:#B8860B;--background-primary:#FFFFFF;--background-secondary:#F8F8F8;--text-primary:#1A1A1A;--text-secondary:#555555;--container-bg:rgba(255,255,255,0.95);--container-border:rgba(212,175,55,0.3);--card-bg:rgba(255,255,255,0.9);--card-border:rgba(212,175,55,0.2);--success-color:#00A859;--warning-color:#E6B400;--error-color:#E53935}*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter','Helvetica Neue',Arial,sans-serif}body{background:var(--background-primary);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;color:var(--text-primary);transition:var(--transition);font-weight:300;position:relative;overflow-x:hidden}body::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 80%,rgb(212 175 55/.1) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgb(244 228 184/.1) 0%,transparent 50%),radial-gradient(circle at 40% 40%,rgb(184 134 11/.05) 0%,transparent 50%);z-index:-1;animation:backgroundShift 20s ease-in-out infinite alternate}@keyframes backgroundShift{0%{transform:scale(1) rotate(0deg)}100%{transform:scale(1.1) rotate(3deg)}}.wallet-container{width:100%;max-width:95%;background:var(--container-bg);backdrop-filter:blur(40px);padding:40px 30px;box-shadow:var(--shadow-luxury);border:1px solid var(--container-border);position:relative;transition:var(--transition);border-radius:24px;overflow:hidden;animation:containerEntrance 1.2s cubic-bezier(.25,.46,.45,.94)}.wallet-container::before{content:'';position:absolute;top:0;left:0;right:0;height:6px;background:var(--gradient-gold);z-index:2}.wallet-container::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,transparent 65%,rgb(212 175 55/.03) 65%),linear-gradient(-45deg,transparent 65%,rgb(244 228 184/.03) 65%);pointer-events:none;z-index:1}@keyframes containerEntrance{0%{opacity:0;transform:translateY(60px) scale(.95)}100%{opacity:1;transform:translateY(0) scale(1)}}header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:40px;padding-bottom:20px;border-bottom:1px solid rgb(212 175 55/.3);animation:fadeInDown 1s 0.3s both;position:relative;flex-wrap:wrap;gap:20px}header::after{content:'';position:absolute;bottom:-1px;left:0;width:100px;height:2px;background:var(--gradient-gold)}.logo{text-align:center;flex:1;min-width:300px}.logo h1{font-family:'Cinzel',serif;font-size:2.2rem;font-weight:600;letter-spacing:2px;color:var(--text-primary);text-transform:uppercase;position:relative;display:inline-block;text-shadow:0 2px 10px rgb(212 175 55/.3)}.logo h1::after{content:'';position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);width:80px;height:3px;background:var(--gradient-gold);border-radius:2px}.logo span{display:block;font-size:0.8rem;letter-spacing:6px;margin-top:10px;color:var(--text-secondary);font-weight:300}.theme-controls{display:flex;gap:15px;flex-wrap:wrap;justify-content:center}.theme-toggle-btn{background:#fff0;border:1px solid var(--container-border);color:var(--primary-color);padding:12px 20px;cursor:pointer;font-size:0.9rem;display:flex;align-items:center;gap:8px;transition:var(--transition);font-weight:400;letter-spacing:1px;border-radius:10px;min-width:140px;justify-content:center;position:relative;overflow:hidden}.theme-toggle-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgb(212 175 55/.2),transparent);transition:all 0.8s ease}.theme-toggle-btn:hover::before{left:100%}.theme-toggle-btn:hover{border-color:var(--primary-color);background:rgb(212 175 55/.05);transform:translateY(-3px);box-shadow:var(--shadow-gold)}.btn{width:100%;padding:18px;border:none;cursor:pointer;font-size:0.95rem;font-weight:500;letter-spacing:1px;text-transform:uppercase;transition:var(--transition);margin-bottom:12px;border-radius:12px;position:relative;overflow:hidden}.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgb(255 255 255/.4),transparent);transition:all 0.8s ease}.btn:hover::before{left:100%}.btn::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:var(--wet-mirror);opacity:0;transition:opacity 0.5s ease;border-radius:12px;z-index:0}.btn:hover::after{opacity:1}.btn-primary{background:var(--gradient-gold);color:#1A1A1A;box-shadow:var(--shadow-gold);font-weight:600;position:relative;z-index:1}.btn-primary:hover{box-shadow:0 15px 40px rgb(212 175 55/.5);transform:translateY(-5px)}.btn-secondary{background:#fff0;color:var(--text-secondary);border:1px solid var(--container-border);box-shadow:0 4px 15px rgb(0 0 0/.1);position:relative;z-index:1}.btn-secondary:hover{border-color:var(--primary-color);color:var(--primary-color);transform:translateY(-3px);box-shadow:var(--shadow-gold)}.btn-small{width:auto;padding:12px 20px;font-size:0.85rem}.btn-success{background:linear-gradient(135deg,var(--success-color),#00E676);color:#fff;box-shadow:0 8px 25px rgb(0 200 83/.4)}.btn-success:hover{box-shadow:0 12px 30px rgb(0 200 83/.6)}.restore-mnemonic-btn{background:#fff0;border:1px solid var(--container-border);color:var(--text-secondary);padding:8px 12px;cursor:pointer;font-size:0.75rem;transition:var(--transition);border-radius:6px;display:flex;align-items:center;gap:5px;margin-top:10px;position:relative;overflow:hidden}.restore-mnemonic-btn::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:var(--wet-mirror);opacity:0;transition:opacity 0.5s ease;border-radius:6px;z-index:0}.restore-mnemonic-btn:hover::after{opacity:1}.restore-mnemonic-btn:hover{border-color:var(--primary-color);color:var(--primary-color);background:rgb(212 175 55/.05)}@keyframes fadeInUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInDown{from{opacity:0;transform:translateY(-40px)}to{opacity:1;transform:translateY(0)}}.animate-element{animation:fadeInUp 0.8s cubic-bezier(.25,.46,.45,.94) both}.delay-1{animation-delay:0.1s}.delay-2{animation-delay:0.2s}.delay-3{animation-delay:0.3s}.delay-4{animation-delay:0.4s}.delay-5{animation-delay:0.5s}.wallet-header{text-align:center;margin-bottom:40px}.wallet-header h2{font-family:'Cinzel',serif;font-size:2rem;font-weight:600;letter-spacing:2px;color:var(--text-primary);margin-bottom:15px;position:relative;display:inline-block;text-shadow:0 2px 10px rgb(212 175 55/.3)}.wallet-header h2::after{content:'';position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);width:60px;height:3px;background:var(--gradient-gold);border-radius:2px}.wallet-header p{color:var(--text-secondary);font-size:1rem;max-width:600px;margin:0 auto;line-height:1.6;font-weight:300;letter-spacing:.3px}.balance-container{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:40px 0;padding:40px 30px;border-radius:24px;background:var(--gradient-card);border:1px solid rgb(212 175 55/.2);overflow:hidden;backdrop-filter:blur(20px)}.balance-container::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 30% 30%,rgb(212 175 55/.1) 0%,transparent 50%),radial-gradient(circle at 70% 70%,rgb(244 228 184/.1) 0%,transparent 50%);z-index:-1}.balance-display{position:relative;z-index:1;font-size:2.8rem;font-weight:600;color:var(--primary-color);margin:15px 0;font-family:'Cinzel',serif;text-align:center;text-shadow:0 2px 10px rgb(212 175 55/.3)}.balance-label{position:relative;z-index:1;font-size:0.95rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:2px;margin-top:15px}.balance-brl{font-size:1.8rem;color:var(--success-color);font-weight:500;margin-top:10px;font-family:'Cinzel',serif}.dashboard-grid{display:grid;grid-template-columns:1fr;gap:30px;margin-bottom:40px}.info-card{background:var(--card-bg);padding:30px;border-radius:20px;border:1px solid var(--card-border);transition:var(--transition);animation:slideInUp 1s 0.5s both;position:relative;overflow:hidden;backdrop-filter:blur(20px)}.info-card::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.info-card::after{content:'';position:absolute;top:0;right:0;width:100px;height:100px;background:radial-gradient(circle,rgb(212 175 55/.1) 0%,transparent 70%);z-index:0}.info-card:hover{transform:translateY(-10px);box-shadow:var(--shadow-luxury);border-color:var(--primary-color)}.info-card h3{font-family:'Cinzel',serif;color:var(--primary-color);margin-bottom:20px;font-size:1.5rem;display:flex;align-items:center;gap:10px;font-weight:500;position:relative;z-index:1}.form-row{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap}.address-display{background:rgb(212 175 55/.08);border:1px solid rgb(212 175 55/.2);padding:12px;border-radius:8px;font-family:'Courier New',monospace;font-size:0.9rem;word-break:break-all;margin-bottom:10px}.tab-navigation{display:flex;flex-wrap:wrap;justify-content:center;gap:4px;margin:30px 0 25px 0;background:rgb(212 175 55/.05);padding:6px 10px;border-radius:16px;border:1px solid var(--container-border);backdrop-filter:blur(10px)}.tab-button{background:#fff0;border:1px solid var(--container-border);color:var(--text-secondary);padding:10px 15px;cursor:pointer;font-size:0.85rem;transition:var(--transition);font-weight:500;letter-spacing:1px;border-radius:10px;display:flex;align-items:center;gap:8px;position:relative;overflow:hidden;flex:1 1 auto;min-width:120px;justify-content:center}.tab-button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgb(212 175 55/.2),transparent);transition:all 0.6s ease}.tab-button:hover::before{left:100%}.tab-button:hover{border-color:var(--primary-color);color:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-gold)}.tab-button.active{background:rgb(212 175 55/.1);border-color:var(--primary-color);color:var(--primary-color);box-shadow:var(--shadow-gold)}.tab-content{display:none;opacity:0;transition:opacity 0.5s ease}.tab-content.active{display:block;opacity:1}.hidden{display:none!important}.fade-out{animation:fadeOut 0.8s cubic-bezier(.25,.46,.45,.94) both}@keyframes fadeOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-30px)}}.fade-in{animation:fadeIn 0.8s 0.3s cubic-bezier(.25,.46,.45,.94) both}@keyframes fadeIn{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.agenda-container{margin-top:30px}.agenda-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:15px}.agenda-month-nav{display:flex;align-items:center;gap:10px;flex-wrap:wrap}.agenda-month-title{font-family:'Cinzel',serif;font-size:1.2rem;color:var(--primary-color);font-weight:600;min-width:180px;text-align:center}.agenda-calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:25px;background:rgb(212 175 55/.05);padding:12px;border-radius:12px;border:1px solid var(--container-border)}.agenda-day{background:var(--card-bg);border:1px solid var(--card-border);border-radius:6px;padding:6px;min-height:70px;transition:var(--transition)}.agenda-day:hover{border-color:var(--primary-color);background:rgb(212 175 55/.05);transform:translateY(-3px)}.agenda-day.selected{border:2px solid var(--primary-color);background:var(--wet-mirror);box-shadow:0 0 20px rgb(212 175 55/.3)}.agenda-day-number{font-size:0.9rem;font-weight:600;color:var(--text-primary);margin-bottom:5px}.agenda-day-event{background:var(--gradient-gold);color:var(--carbon);font-size:0.75rem;padding:3px 6px;border-radius:4px;margin-top:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:500}.agenda-event-form{background:var(--card-bg);border:1px solid var(--card-border);border-radius:12px;padding:20px;margin-top:20px}.token-item{display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:12px;margin-bottom:10px;transition:var(--transition);flex-wrap:wrap}.token-item:hover{border-color:var(--primary-color);transform:translateY(-3px);box-shadow:var(--shadow-gold)}.token-info{display:flex;align-items:center;gap:12px;flex:1;min-width:200px}.token-symbol{font-weight:600;color:var(--text-primary)}.token-balance{font-weight:600;color:var(--primary-color)}.address-registration-box{background:var(--card-bg);border:1px solid var(--card-border);border-radius:20px;padding:25px;margin-top:30px;position:relative;overflow:hidden}.address-registration-box::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.address-registration-title{font-family:'Cinzel',serif;color:var(--primary-color);margin-bottom:15px;font-size:1.4rem;display:flex;align-items:center;gap:10px;font-weight:500}.address-instruction{color:var(--text-secondary);font-size:0.95rem;line-height:1.6;margin-bottom:20px}.wallet-address-display{display:flex;align-items:center;justify-content:space-between;background:rgb(212 175 55/.08);border:1px solid rgb(212 175 55/.2);border-radius:8px;padding:12px;margin-bottom:20px;font-family:'Courier New',monospace;flex-wrap:wrap;gap:10px}.address-text{color:var(--text-primary);font-size:0.9rem;word-break:break-all;flex:1}.copy-btn{background:rgb(212 175 55/.1);border:1px solid var(--primary-color);color:var(--primary-color);padding:8px 15px;border-radius:6px;cursor:pointer;font-size:0.85rem;display:flex;align-items:center;gap:8px;transition:var(--transition)}.copy-btn:hover{background:rgb(212 175 55/.2);transform:translateY(-2px)}.verification-status{display:flex;align-items:center;gap:10px;margin:20px 0 25px 0}.status-indicator{width:12px;height:12px;border-radius:50%}.status-indicator.verified{background:var(--success-color);box-shadow:0 0 10px var(--success-color)}.communication-badges{display:flex;flex-wrap:wrap;gap:10px;margin:25px 0}.communication-badge{background:var(--gradient-card);border:1px solid rgb(212 175 55/.2);border-radius:8px;padding:8px 12px;font-size:0.85rem;display:flex;align-items:center;gap:8px;color:var(--text-primary);transition:var(--transition);flex:1 1 auto;min-width:140px}.communication-badge.unlocked{border-color:var(--success-color);background:rgb(0 200 83/.1)}.communication-badge i{color:var(--primary-color)}.communication-badge.unlocked i{color:var(--success-color)}.input-group{margin-bottom:25px}.input-group label{display:block;font-size:0.9rem;margin-bottom:10px;color:var(--text-secondary);letter-spacing:1px;font-weight:400}.input-group input,.input-group textarea,.input-group select{width:100%;padding:15px 18px;border:1px solid var(--container-border);background:var(--card-bg);font-size:1rem;color:var(--text-primary);transition:var(--transition);border-radius:12px;font-weight:300;backdrop-filter:blur(10px);resize:vertical;font-family:'Inter',sans-serif}.input-group input:focus,.input-group textarea:focus,.input-group select:focus{outline:none;border-color:var(--primary-color);background:var(--background-secondary);box-shadow:0 0 0 3px rgb(212 175 55/.2)}.notification{position:fixed;top:30px;right:30px;padding:20px 25px;background:var(--container-bg);border:1px solid var(--primary-color);border-radius:16px;color:var(--text-primary);z-index:10000;transform:translateX(500px);transition:transform 0.6s cubic-bezier(.25,.46,.45,.94);box-shadow:var(--shadow-luxury);backdrop-filter:blur(20px);max-width:350px}.notification.show{transform:translateX(0)}.notification::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgb(10 10 10/.8);backdrop-filter:blur(10px);display:flex;justify-content:center;align-items:center;z-index:10000;opacity:0;visibility:hidden;transition:var(--transition)}.modal-overlay.active{opacity:1;visibility:visible}.modal-content{background:var(--container-bg);border:1px solid var(--container-border);border-radius:24px;padding:30px;max-width:90%;width:90%;max-height:90vh;overflow-y:auto;position:relative;transform:translateY(50px) scale(.9);opacity:0;transition:var(--transition);box-shadow:var(--shadow-luxury)}.modal-overlay.active .modal-content{transform:translateY(0) scale(1);opacity:1}.modal-content::before{content:'';position:absolute;top:0;left:0;right:0;height:6px;background:var(--gradient-gold);border-radius:24px 24px 0 0}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:15px;border-bottom:1px solid var(--container-border);flex-wrap:wrap;gap:15px}.modal-title{font-family:'Cinzel',serif;color:var(--primary-color);font-size:1.5rem;font-weight:600}.modal-close{background:#fff0;border:none;color:var(--text-secondary);font-size:1.5rem;cursor:pointer;transition:var(--transition);width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center}.modal-close:hover{color:var(--primary-color);background:rgb(212 175 55/.1)}.modal-body{margin-bottom:25px}.modal-footer{display:flex;justify-content:flex-end;gap:12px;padding-top:20px;border-top:1px solid var(--container-border);flex-wrap:wrap}.dev-agenda-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px;margin-top:20px}.agenda-entry{background:var(--card-bg);border:1px solid var(--card-border);border-radius:12px;padding:18px;transition:var(--transition)}.agenda-entry:hover{border-color:var(--primary-color);transform:translateY(-3px);box-shadow:var(--shadow-gold)}.agenda-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.agenda-title{font-weight:600;color:var(--text-primary);font-size:0.95rem}.agenda-status{font-size:0.75rem;padding:4px 8px;border-radius:12px;font-weight=500;letter-spacing:.5px}.status-completed{background:rgb(0 200 83/.15);color:var(--success-color);border:1px solid var(--success-color)}.status-in-progress{background:rgb(255 215 0/.15);color:var(--warning-color);border:1px solid var(--warning-color)}.status-planning{background:rgb(212 175 55/.15);color:var(--primary-color);border:1px solid var(--primary-color)}.agenda-description{color:var(--text-secondary);font-size:0.85rem;line-height:1.5;margin-bottom:12px}.agenda-footer{display:flex;justify-content:space-between;font-size:0.75rem;color:var(--text-secondary);flex-wrap:wrap}.agenda-wallet{font-family:'Courier New',monospace;color:var(--primary-color)}.sub-tab-navigation{display:flex;gap:4px;margin:20px 0 25px 0;background:rgb(212 175 55/.05);padding:6px 10px;border-radius:16px;border:1px solid var(--container-border);backdrop-filter:blur(10px);flex-wrap:wrap}.sub-tab-btn{background:#fff0;border:1px solid var(--container-border);color:var(--text-secondary);padding:8px 12px;cursor:pointer;font-size:0.8rem;transition:var(--transition);font-weight:500;letter-spacing:.5px;border-radius:8px;display:flex;align-items:center;gap:8px;position:relative;overflow:hidden;flex:1 1 auto;min-width:100px}.sub-tab-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgb(212 175 55/.2),transparent);transition:all 0.6s ease}.sub-tab-btn:hover::before{left:100%}.sub-tab-btn:hover{border-color:var(--primary-color);color:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-gold)}.sub-tab-btn.active{background:rgb(212 175 55/.1);border-color:var(--primary-color);color:var(--primary-color);box-shadow:var(--shadow-gold)}.sub-tab-content{display:block;opacity:1;transition:opacity 0.5s ease}.sub-tab-content.hidden{display:none;opacity:0}.contacts-list-container{max-height:300px;overflow-y:auto;margin:20px 0;border:1px solid var(--card-border);border-radius:12px;padding:12px}.contact-item{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--card-border);transition:var(--transition);flex-wrap:wrap;gap:10px}.contact-item:hover{background:var(--gradient-card)}.contact-item:last-child{border-bottom:none}.contact-info{display:flex;align-items:center;gap:12px;flex:1;min-width:200px}.contact-actions{display:flex;gap:8px;flex-wrap:wrap}.add-contact-form{margin-top:25px;padding:18px;border:1px solid var(--card-border);border-radius:12px;background:var(--card-bg)}.chat-container{display:flex;flex-direction:column;height:400px;border:1px solid var(--card-border);border-radius:12px;overflow:hidden}.chat-messages{flex:1;overflow-y:auto;padding:15px;background:var(--card-bg)}.chat-input-area{display:flex;gap:10px;padding:12px;border-top:1px solid var(--card-border);background:var(--background-secondary)}.chat-input{flex:1;padding:10px 12px;border:1px solid var(--card-border);border-radius:8px;background:var(--card-bg);color:var(--text-primary);font-size:0.9rem}.message{margin-bottom:12px;padding:8px 12px;border-radius:12px;max-width:90%;word-wrap:break-word}.message-received{background:var(--card-bg);border:1px solid var(--card-border);align-self:flex-start}.message-sent{background:var(--gradient-gold);color:#1A1A1A;align-self:flex-end;margin-left:auto}.message-sender{font-weight:600;font-size:0.8rem;margin-bottom:5px;color:var(--primary-color)}.message-time{font-size:0.7rem;color:var(--text-secondary);margin-top:5px;text-align:right}.video-container{width:100%;height:250px;background:#000;border-radius:12px;overflow:hidden;position:relative;display:flex;align-items:center;justify-content:center;margin-bottom:15px}.video-placeholder{text-align:center;color:#fff}.video-placeholder i{font-size=2.5rem;margin-bottom:10px;color:var(--primary-color)}.video-controls{display:flex;gap:10px;flex-wrap:wrap}.video-call-container{position:relative}.video-call-container video{width:100%;height:100%;object-fit:cover;border-radius:12px}.local-video{position:absolute;bottom:15px;right:15px;width:100px;height:75px;border:2px solid var(--primary-color);border-radius:6px;overflow:hidden;background:#000}.local-video video{width:100%;height:100%;object-fit:cover}.group-video-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:8px;margin-top:15px}.group-video-item{background:#000;border-radius:6px;overflow:hidden;position:relative;aspect-ratio:16/9}.group-video-item video{width:100%;height:100%;object-fit:cover}.group-video-overlay{position:absolute;bottom:5px;left:5px;background:rgb(0 0 0/.7);color:#fff;padding:3px 6px;border-radius:4px;font-size:0.7rem}.info-card:hover::after,.btn:hover::after,.tab-button:hover::after,.sub-tab-btn:hover::after,.theme-toggle-btn:hover::after,.contact-item:hover::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:var(--wet-mirror);opacity:.6;pointer-events:none;border-radius:inherit;z-index:1}.communication-main-container{background:var(--card-bg);border:1px solid var(--card-border);border-radius:24px;padding:25px;margin-top:20px;min-height:500px;position:relative;overflow:hidden}.communication-main-container::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.authorization-box{background:var(--gradient-card);border:1px solid var(--card-border);border-radius:20px;padding:20px;margin-top:25px;position:relative;overflow:hidden}.authorization-box::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.language-selector-container{position:fixed;bottom:20px;right:20px;z-index:1000}.language-toggle-btn{background:var(--card-bg);border:1px solid var(--primary-color);color:var(--primary-color);width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size=1.2rem;cursor:pointer;transition:var(--transition);box-shadow:var(--shadow-luxury)}.language-toggle-btn:hover{transform:scale(1.1) rotate(15deg);background:rgb(212 175 55/.1)}.language-panel{position:absolute;bottom:60px;right:0;background:var(--container-bg);border:1px solid var(--container-border);border-radius:16px;padding:15px;width:180px;backdrop-filter:blur(20px);box-shadow:var(--shadow-luxury);display:none}.language-panel.active{display:block}.language-panel::before{content:'';position:absolute;top:0;left:0;right:0;height:6px;background:var(--gradient-gold);border-radius:16px 16px 0 0}.language-item{padding:8px;border-bottom:1px solid var(--card-border);cursor:pointer;transition:var(--transition);font-size=0.9rem;display:flex;align-items:center;gap:8px}.language-item:hover{background:var(--gradient-card);color:var(--primary-color)}.language-item:last-child{border-bottom:none}.global-value-display{text-align:center;padding:25px;background:var(--gradient-card);border-radius:24px;border:1px solid rgb(212 175 55/.2);margin-bottom:30px;position:relative;overflow:hidden;backdrop-filter:blur(20px)}.global-value-display::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 30% 30%,rgb(212 175 55/.1) 0%,transparent 50%),radial-gradient(circle at 70% 70%,rgb(244 228 184/.1) 0%,transparent 50%);z-index:-1}.global-value-label{font-size=0.9rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:2px;margin-bottom:8px;font-weight=400}.global-value-amount{font-size:2.5rem;font-weight:600;color:var(--success-color);font-family:'Cinzel',serif;text-shadow:0 2px 10px rgb(0 200 83/.3);margin:12px 0}.token-price-info{font-size=0.8rem;color:var(--text-secondary);display:flex;align-items:center;gap:5px;margin-top:3px;font-weight:300}.token-price-info i{font-size=0.75rem;color:var(--primary-color)}.token-price-source{font-size=0.7rem;color:var(--gold-accent);font-style:italic}.nft-item{display:flex;align-items:center;gap:12px;padding:10px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:10px;margin-bottom:8px;transition:var(--transition);flex-wrap:wrap}.nft-item:hover{border-color:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-gold)}.nft-image{width:50px;height:50px;border-radius:6px;object-fit:cover;border:1px solid var(--container-border)}.nft-info{flex:1;min-width:150px}.nft-name{font-weight:600;font-size=0.9rem;color:var(--text-primary)}.nft-collection{font-size=0.8rem;color:var(--text-secondary);margin-top:2px}.nft-id{font-size=0.75rem;color:var(--primary-color);font-family:'Courier New',monospace}.action-btn-minimal{background:var(--card-bg);border:1px solid var(--card-border);border-radius:10px;padding:12px 8px;cursor:pointer;transition:var(--transition);display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--text-primary);font-size=0.85rem;min-height:70px;flex:1 1 100px}.action-btn-minimal:hover{border-color:var(--primary-color);transform:translateY(-2px);box-shadow:var(--shadow-gold)}.action-btn-minimal i{font-size=1.5rem;color:var(--primary-color);margin-bottom:6px}.action-btn-minimal span{font-size=0.8rem;font-weight:500;letter-spacing:.5px;text-align:center}.export-counter-warning{background:rgb(224 17 95 / .1);border:1px solid var(--error-color);border-radius:8px;padding:10px;margin:12px 0;font-size=0.8rem;color:var(--error-color);text-align:center;display:flex;align-items:center;justify-content:center;gap:6px}.export-counter-warning i{font-size=0.9rem}.legal-text-container{max-height:250px;overflow-y:auto;padding:12px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:8px;margin-bottom:15px;font-size=0.8rem;line-height:1.5;color:var(--text-secondary)}.legal-section-title{font-weight:600;color:var(--primary-color);margin-top:12px;margin-bottom:6px;font-size=0.9rem;font-family:'Cinzel',serif}.wallet-main-container{background:var(--card-bg);border:1px solid var(--card-border);border-radius:24px;padding:25px;margin-top:20px;position:relative;overflow:hidden;backdrop-filter:blur(20px)}.wallet-main-container::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.balance-main-container{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:25px 0;padding:30px;border-radius:24px;background:var(--gradient-card);border:1px solid rgb(212 175 55/.2);overflow:hidden;backdrop-filter:blur(20px)}.balance-main-container::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 30% 30%,rgb(212 175 55/.1) 0%,transparent 50%),radial-gradient(circle at 70% 70%,rgb(244 228 184/.1) 0%,transparent 50%);z-index:-1}.wallet-operations-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin-bottom:25px}.blockchain-buttons-container{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:25px;padding:15px;background:var(--gradient-card);border-radius:20px;border:1px solid rgb(212 175 55/.2);backdrop-filter:blur(20px)}.blockchain-button{background:var(--card-bg);border:1px solid var(--card-border);color:var(--text-primary);padding:12px 18px;cursor:pointer;font-size=0.85rem;transition:var(--transition);font-weight:500;letter-spacing:.5px;border-radius:10px;text-transform:uppercase;flex:1 1 auto;min-width:100px;max-width:200px;text-align:center;position:relative;overflow:hidden;height:45px;display:flex;align-items:center;justify-content:center}.blockchain-button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgb(212 175 55/.2),transparent);transition:all 0.6s ease}.blockchain-button:hover::before{left:100%}.blockchain-button:hover{border-color:var(--primary-color);color:var(--primary-color);transform:translateY(-3px);box-shadow:var(--shadow-gold);background:rgb(212 175 55/.05)}.blockchain-button.active{background:rgb(212 175 55/.1);border-color:var(--primary-color);color:var(--primary-color);box-shadow:var(--shadow-gold)}.blockchain-divider{height:1px;background:var(--gradient-gold);margin:25px 0;width:100%}.blockchain-empty-area{min-height:250px;display:flex;align-items:center;justify-content:center;color:var(--text-secondary);font-size=0.95rem;font-style:italic;padding:30px;background:var(--gradient-card);border-radius:20px;border:1px solid var(--card-border)}.sound-exclusive-container{background:var(--card-bg);border:1px solid var(--card-border);border-radius:24px;padding:25px;margin-top:20px;min-height:500px;position:relative;overflow:hidden;backdrop-filter:blur(20px)}.sound-exclusive-container::before{content:'';position:absolute;top:0;left:0;width:6px;height:100%;background:var(--gradient-gold)}.sound-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:15px;border-bottom:1px solid rgb(212 175 55/.2);flex-wrap:wrap;gap:20px}.sound-usage-counter{display:flex;align-items:center;gap:8px;background:rgb(212 175 55/.1);padding:6px 12px;border-radius:12px;border:1px solid rgb(212 175 55/.2)}.usage-count{font-weight:600;color:var(--primary-color);font-size=1.2rem}.usage-warning{color:var(--warning-color);font-size=0.8rem;display:flex;align-items:center;gap:5px}.sound-chat-container{display:flex;flex-direction:column;height:450px;border-radius:16px;overflow:hidden;background:var(--background-secondary);border:1px solid var(--card-border)}.sound-chat-messages{flex:1;overflow-y:auto;padding:15px;display:flex;flex-direction:column;gap:12px}.sound-chat-input-area{display:flex;gap:10px;padding:15px;border-top:1px solid var(--card-border);background:var(--container-bg)}.sound-chat-input{flex:1;padding:12px 15px;border:1px solid var(--card-border);border-radius:12px;background:var(--card-bg);color:var(--text-primary);font-size=1rem;font-family:'Inter',sans-serif}.sound-message{padding:12px 15px;border-radius:16px;max-width:90%;word-wrap:break-word;position:relative}.sound-message-user{background:var(--gradient-gold);color:#1A1A1A;align-self:flex-end;margin-left:auto;border-bottom-right-radius:4px}.sound-message-ai{background:var(--card-bg);border:1px solid var(--card-border);align-self:flex-start;border-bottom-left-radius:4px}.sound-message-sender{font-weight:600;font-size=0.8rem;margin-bottom:6px;color:var(--primary-color)}.sound-message-time{font-size=0.75rem;color:var(--text-secondary);margin-top:6px;text-align:right}.sound-voice-controls{display:flex;justify-content:center;gap:15px;margin-top:25px;padding:20px;background:var(--gradient-card);border-radius:20px;border:1px solid rgb(212 175 55/.2);flex-wrap:wrap}.sound-voice-btn{display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:16px;cursor:pointer;transition:var(--transition);min-width:120px;text-align:center;flex:1 1 auto}.sound-voice-btn:hover{transform:translateY(-5px);border-color:var(--primary-color);box-shadow:var(--shadow-gold)}.sound-voice-btn i{font-size=1.8rem;color:var(--primary-color)}.sound-voice-btn span{font-size=0.85rem;font-weight:500;letter-spacing:.5px}.sound-status-indicator{display:flex;align-items:center;gap:6px;margin-top:15px;padding:10px 15px;background:rgb(212 175 55/.05);border-radius:12px;border:1px solid rgb(212 175 55/.1)}.sound-status-dot{width:10px;height:10px;border-radius:50%;background:var(--success-color)}.sound-status-dot.thinking{background:var(--warning-color);animation:pulse 1.5s infinite}.sound-status-dot.error{background:var(--error-color)}@keyframes pulse{0%{opacity:.4}50%{opacity:1}100%{opacity:.4}}.sound-thinking-indicator{display:none;align-items:center;gap:8px;padding:10px 15px;background:rgb(255 215 0/.1);border-radius:12px;border:1px solid var(--warning-color);margin:12px 0}.sound-thinking-text{color:var(--warning-color);font-size=0.9rem}.sound-typing-dots{display:flex;gap:3px}.sound-typing-dot{width:6px;height:6px;border-radius:50%;background:var(--warning-color);animation:typing 1.4s infinite}.sound-typing-dot:nth-child(2){animation-delay:0.2s}.sound-typing-dot:nth-child(3){animation-delay:0.4s}@keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-6px)}}.sound-empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:350px;color:var(--text-secondary);text-align:center}.sound-empty-icon{font-size=3.5rem;color:rgb(212 175 55/.3);margin-bottom:15px}.qr-container{width:180px;height:180px;margin:0 auto 15px;padding:8px;background:#fff;border-radius:10px;border:1px solid var(--gold-primary)}.theme-light .qr-container{border:1px solid var(--gold-dark)}.tx-history-item{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--card-border);transition:var(--transition);flex-wrap:wrap}.tx-history-item:hover{background:var(--gradient-card)}.tx-history-item:last-child{border-bottom:none}.tx-info{display:flex;align-items:center;gap:10px}.tx-icon{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size=0.9rem}.tx-in{background:rgb(0 200 83 / .15);color:var(--success-color)}.tx-out{background:rgb(224 17 95 / .15);color:var(--error-color)}.tx-pending{background:rgb(255 215 0 / .15);color:var(--warning-color)}.tx-amount{font-weight:600}.tx-in .tx-amount{color:var(--success-color)}.tx-out .tx-amount{color:var(--error-color)}.tx-pending .tx-amount{color:var(--warning-color)}.mnemonic-timer-container{text-align:center;padding:25px;background:var(--gradient-card);border-radius:12px;margin:15px 0}.mnemonic-timer{font-size=3rem;font-weight:600;color:var(--primary-color);font-family:'Cinzel',serif;margin:15px 0}.mnemonic-warning{color:var(--warning-color);font-size=0.9rem;margin-top:8px}.mnemonic-words{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px;margin:20px 0}.mnemonic-word{background:var(--card-bg);border:1px solid var(--card-border);padding:10px;border-radius:8px;text-align:center;font-size=0.9rem;position:relative;overflow:hidden}.mnemonic-word::before{content:attr(data-index);position:absolute;top:2px;left:2px;font-size=0.7rem;color:var(--text-secondary)}.action-buttons{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}.action-btn{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;background:var(--card-bg);border:1px solid var(--card-border);border-radius:12px;padding:20px;cursor:pointer;transition:var(--transition);min-width:100px;text-align:center;flex:1 1 auto}.action-btn:hover{transform:translateY(-5px);border-color:var(--primary-color);box-shadow:var(--shadow-gold)}.action-btn i{font-size=1.8rem;color:var(--primary-color)}.action-btn span{font-size=0.8rem;font-weight:500;letter-spacing:.5px}
   .token-details-row{display:flex;flex-direction:column;margin-top:10px;padding-top:10px;border-top:1px solid rgb(212 175 55 / .2);font-size=0.75rem;color:var(--text-secondary)}.token-details-row .detail-row{display:flex;justify-content:space-between;margin-bottom:4px;flex-wrap:wrap}.token-details-row .detail-label{color:var(--gold-accent);font-weight:500}.token-details-row .detail-value{font-family:'Courier New',monospace;color:var(--text-primary)}.nft-details-row{display:flex;flex-direction:column;margin-top:10px;padding-top:10px;border-top:1px solid rgb(212 175 55 / .2);font-size=0.75rem;color:var(--text-secondary)}.nft-details-row .detail-row{display:flex;justify-content:space-between;margin-bottom:4px;flex-wrap:wrap}.nft-details-row .detail-label{color:var(--gold-accent);font-weight:500}.nft-details-row .detail-value{font-family:'Courier New',monospace;color:var(--text-primary)}.real-tx-badge{background:linear-gradient(135deg,rgb(0 200 83 / .15),rgb(0 230 118 / .1));border:1px solid var(--success-color);color:var(--success-color);padding:2px 6px;border-radius:4px;font-size=0.7rem;font-weight:500;margin-left:8px;display:inline-flex;align-items:center;gap:3px}.real-gas-badge{background:linear-gradient(135deg,rgb(212 175 55 / .15),rgb(244 228 184 / .1));border:1px solid var(--primary-color);color:var(--primary-color);padding:2px 6px;border-radius:4px;font-size=0.7rem;font-weight:500;margin-left:8px;display:inline-flex;align-items:center;gap:3px}.real-price-badge{background:linear-gradient(135deg,rgb(15 82 186 / .15),rgb(0 102 255 / .1));border:1px solid var(--sapphire);color:var(--sapphire);padding:2px 6px;border-radius:4px;font-size=0.7rem;font-weight:500;margin-left:8px;display:inline-flex;align-items:center;gap:3px}.token-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px;flex-wrap:wrap}.token-action-btn{background:var(--gradient-card);border:1px solid var(--card-border);color:var(--text-secondary);padding:6px 10px;border-radius:6px;font-size=0.75rem;cursor:pointer;transition:var(--transition);display:flex;align-items:center;gap=5px}.token-action-btn:hover{background:rgb(212 175 55 / .1);border-color:var(--primary-color);color:var(--primary-color)}.event-item{display:flex;justify-content:space-between;align-items:center;padding:8px;background:var(--gradient-card);border:1px solid var(--card-border);border-radius:8px;margin-bottom:8px;transition:var(--transition);flex-wrap:wrap}.event-item:hover{border-color:var(--primary-color)}.event-info{flex:1;min-width:200px}.event-time{font-size=0.85rem;color:var(--primary-color);font-weight:600}.event-description{font-size=0.8rem;color:var(--text-secondary);margin-top:2px}.nft-action-row{display:flex;justify-content:space-between;align-items:center;margin-top:8px;padding-top:8px;border-top:1px solid rgb(212 175 55 / .1);flex-wrap:wrap;gap:5px}.nft-action-btn{background:var(--gradient-card);border:1px solid var(--card-border);color:var(--text-secondary);padding:4px 8px;border-radius:4px;font-size=0.75rem;cursor:pointer;transition:var(--transition);display:flex;align-items:center;gap:4px}.nft-action-btn:hover{background:rgb(212 175 55 / .1);border-color:var(--primary-color);color:var(--primary-color)}.event-actions{display:flex;gap:5px;flex-wrap:wrap}.event-action-btn{background:var(--gradient-card);border:1px solid var(--card-border);color:var(--text-secondary);padding:4px 8px;border-radius:4px;font-size=0.75rem;cursor:pointer;transition:var(--transition);display:flex;align-items:center;gap=4px}.event-action-btn:hover{background:rgb(212 175 55 / .1);border-color:var(--primary-color);color:var(--primary-color)}.rpc-config-section{margin-top:15px;padding-top:15px;border-top:1px solid var(--card-border);font-size=0.85rem}.rpc-config-title{display:flex;align-items:center;gap:8px;color:var(--primary-color);font-weight:600;margin-bottom:10px;font-family:'Cinzel',serif;font-size=0.9rem}.rpc-option{display:flex;align-items:center;gap:8px;margin-bottom:6px;padding:8px;background:var(--gradient-card);border-radius:6px;border:1px solid #fff0;transition:var(--transition);cursor:pointer;flex-wrap:wrap}.rpc-option:hover{border-color:var(--primary-color);background:rgb(212 175 55 / .05)}.rpc-option.selected{border-color:var(--success-color);background:rgb(0 200 83 / .05)}.rpc-provider{flex:1;font-size=0.8rem;color:var(--text-primary);font-family:'Courier New',monospace;word-break:break-all}.rpc-status{width:6px;height:6px;border-radius:50%;background:var(--success-color)}.rpc-status.offline{background:var(--error-color)}.custom-rpc-input{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}.custom-rpc-input input{flex:1;padding:8px 12px;border:1px solid var(--card-border);background:var(--card-bg);color:var(--text-primary);border-radius:6px;font-size=0.8rem;font-family:'Courier New',monospace;min-width:150px}.custom-rpc-input button{padding:8px 12px;background:var(--gradient-gold);border:none;border-radius:6px;color:#1A1A1A;font-weight:500;font-size=0.8rem;cursor:pointer;transition:var(--transition)}.custom-rpc-input button:hover{transform:translateY(-2px);box-shadow:var(--shadow-gold)}.engine-details{font-size=0.75rem;color:var(--text-secondary);margin-top:4px;font-style:italic}
   
   /* NOVO RODAPÉ FIXO */
   .system-info-frame{position:fixed;bottom:0;left:0;right:0;background:var(--container-bg);border-top:1px solid var(--container-border);padding:8px 15px;font-size:.75rem;color:var(--text-secondary);text-align:center;backdrop-filter:blur(20px);z-index:999}.system-info-frame div:first-child{font-weight:500;color:var(--text-primary);margin-bottom:2px}
   /* ============ MEDIA QUERIES ============ */
   @media (max-width:1200px){.wallet-container{max-width:95%}.dashboard-grid{grid-template-columns:1fr}}@media (max-width:768px){.wallet-container{padding:30px 20px}header{flex-direction:column;text-align:center;gap:15px}.logo h1{font-size=1.8rem;letter-spacing:1px}.logo span{font-size=.7rem;letter-spacing:4px}.balance-display{font-size=2.2rem}.global-value-amount{font-size=2rem}.wallet-header h2{font-size=1.6rem}.tab-button{min-width:110px;padding:8px 12px;font-size=.8rem}.blockchain-button{min-width:90px;padding:10px 15px;font-size=.8rem}.agenda-calendar{grid-template-columns:repeat(7,1fr)}.agenda-day{min-height:60px;padding:4px}.communication-main-container>div{grid-template-columns:1fr;gap:25px}.sound-chat-container{height:400px}}@media (max-width:480px){body{padding:10px}.wallet-container{padding:20px 15px;border-radius:20px}.logo h1{font-size=1.5rem}.logo span{font-size=.6rem;letter-spacing:3px}.theme-toggle-btn{min-width:120px;padding:10px 15px;font-size=.8rem}.global-value-display{padding:20px}.global-value-amount{font-size=1.8rem}.wallet-header h2{font-size=1.4rem}.wallet-header p{font-size=.9rem}.tab-navigation{gap:3px;padding:5px 8px}.tab-button{min-width:90px;padding:6px 10px;font-size=.75rem}.sub-tab-btn{min-width:80px;padding:6px 10px;font-size=.75rem}.blockchain-button{min-width:80px;padding:8px 12px;font-size=.75rem;height:40px}.balance-display{font-size=1.8rem}.info-card{padding:20px}.agenda-calendar{grid-template-columns:repeat(7,1fr);gap:2px;padding:8px}.agenda-day{min-height:50px}.agenda-day-number{font-size=.8rem}.agenda-day-event{font-size=.7rem}.wallet-operations-grid{grid-template-columns:repeat(2,1fr)}.action-btn{padding:15px;min-width:80px}.action-btn i{font-size=1.5rem}.sound-chat-container{height:350px}.sound-voice-controls{gap:10px}.sound-voice-btn{min-width:100px;padding:15px}.notification{max-width:90%;right:5%;left:5%}.modal-content{padding:20px;width:95%}}@media (max-width:360px){.logo h1{font-size=1.3rem}.wallet-header h2{font-size=1.2rem}.tab-button{min-width:80px;font-size=.7rem}.blockchain-button{min-width:70px;font-size=.7rem;padding:6px 10px}.action-btn-minimal{min-width:80px;padding:10px 6px}.agenda-month-title{font-size=1rem;min-width:140px}.agenda-day{min-height:45px}.communication-badge{min-width:120px}}@media (orientation:landscape) and (max-height:600px){.wallet-container{max-height:95vh;overflow-y:auto}.sound-chat-container{height:300px}.chat-container{height:300px}.video-container{height:200px}.local-video{width:80px;height:60px}}@media (min-width:769px){.dashboard-grid{grid-template-columns:1fr 1fr}.communication-main-container>div{grid-template-columns:1fr 1fr}}@media (min-width:1201px){.wallet-container{max-width:1400px}}
  </style>
</head>
<body class="theme-luxury">
  <div class="wallet-container">
    <header>
      <div class="logo">
        <h1>Exclusive Layer Identity</h1>
        <span>PREMIUM BLOCKCHAIN ISOLATED</span>
      </div>
      <div class="theme-controls">
        <button class="theme-toggle-btn" id="themeToggle"><i class="fas fa-sun"></i> Modo Claro</button>
      </div>
    </header>

    <div id="wallet-dashboard">
      <!-- Valor Global da Wallet -->
      <div class="global-value-display" id="globalValueDisplay">
        <div class="global-value-label">Valor Total da Wallet</div>
        <div class="global-value-amount" id="globalWalletValue">$0.00 USD</div>
        <div style="font-size:11px;color:var(--text-secondary);margin-top:8px;">
          <i class="fas fa-sync-alt" style="font-size:10px;"></i> Atualizado em tempo real via CoinGecko API
        </div>
      </div>

      <div class="tab-navigation">
        <button class="tab-button" data-tab="walletTab">
          <i class="fas fa-wallet"></i> Wallet
        </button>
        <button class="tab-button active" data-tab="blockchainsTab">
          <i class="fas fa-link"></i> Blockchains
        </button>
        <button class="tab-button" data-tab="soundExclusiveTab">
          <i class="fas fa-music"></i> IA Exclusive
        </button>
        <button class="tab-button" data-tab="agendaTab">
          <i class="fas fa-calendar-alt"></i> Agenda
        </button>
        <button class="tab-button" data-tab="communicationTab" onclick="window.location.href='communication.html'">
          <i class="fas fa-comments"></i> Comunicação
        </button>
      </div>

      <!-- ABA BLOCKCHAINS -->
      <div class="tab-content active" id="blockchainsTab">
        <div class="wallet-header">
          <h2><i class="fas fa-link"></i> 20 Blockchains Reais</h2>
          <p>Clique em qualquer blockchain para criar ou acessar sua wallet exclusiva</p>
        </div>

        <div class="blockchain-buttons-container" id="blockchainButtonsContainer">
          <!-- Botões serão inseridos via JavaScript -->
        </div>

        <div class="blockchain-empty-area" id="blockchainInfoArea">
          <div style="text-align:center;">
            <i class="fas fa-link" style="font-size:48px;color:var(--text-secondary);opacity:0.3;margin-bottom:20px;"></i>
            <p style="color:var(--text-secondary);font-size:16px;max-width:500px;margin:0 auto;">
              Selecione uma blockchain acima para começar<br>
              Cada blockchain possui sua própria wallet isolada
            </p>
          </div>
        </div>
      </div>

      <!-- ABA WALLET -->
      <div class="tab-content" id="walletTab">
        <div class="wallet-header">
          <h2><i class="fas fa-wallet"></i> Wallet Premium</h2>
          <p>Selecione uma blockchain para gerenciar sua wallet</p>
        </div>
        
        <div class="wallet-main-container" id="walletMainContainer">
          <div class="balance-main-container">
            <div class="balance-label">Sistema Blockchain Isolado</div>
           <div class="balance-display" id="nativeBalance">
  0.0000 ETH
</div>
            <div class="balance-label">EXCLUSIVE WALLET</div>
            <div style="font-size:14px;color:var(--text-secondary);margin-top:15px;text-align:center;">
              Clique em uma blockchain no menu "Blockchains" para começar
            </div>
          </div>
        </div>
      </div>

      <!-- ABA IA EXCLUSIVE -->
      <div class="tab-content" id="soundExclusiveTab">
        <div class="wallet-header">
          <h2><i class="fas fa-music"></i> IA Exclusive</h2>
          <p>IA exclusiva da wallet - Chat por texto e voz</p>
        </div>

        <div class="sound-exclusive-container">
          <div class="sound-header">
            <div>
              <h3 style="color:var(--primary-color);font-family:'Cinzel',serif;">
                <i class="fas fa-robot"></i> IA Exclusive
              </h3>
              <p style="color:var(--text-secondary);font-size:14px;margin-top:5px;">
                Converse com a IA exclusiva da wallet
              </p>
            </div>
            
            <div class="sound-usage-counter">
              <i class="fas fa-clock" style="color:var(--primary-color);"></i>
              <div>
                <div class="usage-count" id="usageCount">20</div>
                <div style="font-size:11px;color:var(--text-secondary);">chamadas restantes</div>
              </div>
            </div>
          </div>

          <div class="sound-chat-container">
            <div class="sound-chat-messages" id="soundChatMessages">
              <div class="sound-empty-state">
                <div class="sound-empty-icon">
                  <i class="fas fa-comments"></i>
                </div>
                <h3 style="color:var(--text-secondary);margin-bottom:10px;">
                  IA Exclusive AI
                </h3>
                <p style="color:var(--text-secondary);max-width:400px;margin:0 auto;">
                  Olá! Sou a IA exclusiva da wallet. Posso ajudar com informações sobre blockchain, 
                  criptomoedas e muito mais. Como posso ajudá-lo hoje?
                </p>
              </div>
            </div>

            <div class="sound-thinking-indicator" id="thinkingIndicator">
              <div class="sound-typing-dots">
                <div class="sound-typing-dot"></div>
                <div class="sound-typing-dot"></div>
                <div class="sound-typing-dot"></div>
              </div>
              <div class="sound-thinking-text">IA Exclusive está digitando...</div>
            </div>

            <div class="sound-chat-input-area">
              <input type="text" class="sound-chat-input" id="soundChatInput" 
                     placeholder="Digite sua mensagem para a IA Exclusive..." 
                     onkeydown="handleSoundChatKeyPress(event)">
              <button class="btn-primary btn-small" onclick="sendSoundMessage()">
                <i class="fas fa-paper-plane"></i> Enviar
              </button>
            </div>
          </div>

          <div class="sound-voice-controls">
            <div class="sound-voice-btn" onclick="startVoiceInput()">
              <i class="fas fa-microphone"></i>
              <span>Falar com IA</span>
            </div>
            
            <div class="sound-voice-btn" onclick="toggleVoiceResponse()">
              <i class="fas fa-volume-up" id="voiceResponseIcon"></i>
              <span id="voiceResponseText">Voz Ativada</span>
            </div>
            
            <div class="sound-voice-btn" onclick="clearSoundChat()">
              <i class="fas fa-trash-alt"></i>
              <span>Limpar Chat</span>
            </div>
          </div>

          <div class="sound-status-indicator">
            <div class="sound-status-dot" id="connectionStatus"></div>
            <div style="color:var(--text-secondary);font-size:13px;">
              <span id="statusText">Conectado ao Cloudflare Worker</span>
            </div>
          </div>
        </div>
      </div>

      <!-- NOVA ABA AGENDA -->
      <div class="tab-content" id="agendaTab">
        <div class="wallet-header">
          <h2><i class="fas fa-calendar-alt"></i> Agenda Premium</h2>
          <p>Gerencie seus compromissos com elegância e segurança local</p>
        </div>

        <div class="wallet-main-container">
          <!-- CONTROLES DO MÊS -->
          <div class="agenda-header">
            <button class="theme-toggle-btn btn-small" onclick="changeAgendaMonth(-1)">
              <i class="fas fa-chevron-left"></i> Mês Anterior
            </button>
            <div class="agenda-month-title" id="currentMonthTitle">Janeiro 2024</div>
            <button class="theme-toggle-btn btn-small" onclick="changeAgendaMonth(1)">
              Próximo Mês <i class="fas fa-chevron-right"></i>
            </button>
          </div>

          <!-- CALENDÁRIO PREMIUM -->
          <div class="agenda-calendar" id="agendaCalendar">
            <!-- Cabeçalho dos dias da semana -->
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              DOM
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              SEG
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              TER
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              QUA
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              QUI
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              SEX
            </div>
            <div class="agenda-day" style="background:transparent;border:none;text-align:center;font-weight:600;color:var(--primary-color);min-height:30px;">
              SAB
            </div>
            <!-- Dias serão gerados via JavaScript -->
          </div>

          <!-- COMPROMISSOS DO DIA SELECIONADO -->
          <div class="info-card" id="dayEventsCard" style="display:none;">
            <h3><i class="fas fa-clock"></i> Compromissos do Dia</h3>
            <div id="selectedDateTitle" style="color:var(--text-secondary);margin-bottom:20px;"></div>
            <div id="dayEventsList">
              <!-- Compromissos serão listados aqui -->
            </div>
            
            <!-- Formulário para novo compromisso -->
            <div class="agenda-event-form">
              <h4 style="color:var(--primary-color);margin-bottom:15px;font-size:16px;">
                <i class="fas fa-plus-circle"></i> Novo Compromisso
              </h4>
              <div class="input-group">
                <label><i class="fas fa-clock"></i> Hora</label>
                <input type="time" id="eventTime" style="font-family:'Inter',sans-serif;">
              </div>
              <div class="input-group">
                <label><i class="fas fa-align-left"></i> Descrição</label>
                <textarea id="eventDescription" rows="3" placeholder="Descreva o compromisso..."></textarea>
              </div>
              <button class="btn-primary btn-small" onclick="addEventToSelectedDate()" style="width:100%;">
                <i class="fas fa-calendar-plus"></i> Adicionar Compromisso
              </button>
            </div>
          </div>

          <!-- AÇÕES DA AGENDA -->
          <div class="wallet-operations-grid" style="margin-top:30px;">
            <div class="action-btn" onclick="exportAgendaToPDF()">
              <i class="fas fa-file-pdf"></i>
              <span>Exportar PDF</span>
            </div>
            <div class="action-btn" onclick="clearAllEvents()">
              <i class="fas fa-trash-alt"></i>
              <span>Limpar Agenda</span>
            </div>
            <div class="action-btn" onclick="loadAgendaData()">
              <i class="fas fa-sync-alt"></i>
              <span>Recarregar</span>
            </div>
          </div>

          <!-- MENSAGEM QUANDO NENHUMA DATA SELECIONADA -->
          <div class="blockchain-empty-area" id="noDateSelectedMessage">
            <div style="text-align:center;">
              <i class="fas fa-calendar-day" style="font-size:48px;color:var(--text-secondary);opacity:0.3;margin-bottom:20px;"></i>
              <p style="color:var(--text-secondary);font-size:16px;max-width:500px;margin:0 auto;">
                Selecione uma data no calendário para visualizar ou adicionar compromissos
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- NOVA ABA COMUNICAÇÃO (SIMPLIFICADA - REDIRECIONA PARA PÁGINA SEPARADA) -->
      <div class="tab-content" id="communicationTab" style="display:none;">
        <div class="wallet-header">
          <h2><i class="fas fa-comments"></i> Comunicação Premium</h2>
          <p>Redirecionando para sistema de comunicação P2P...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- RODAPÉ FIXO COM INFORMAÇÕES DO SISTEMA -->
  <div class="system-info-frame" id="systemInfoFrame">
    <div>exclusive layer identity © 2026 - sistema 100% p2p serverless</div>
    <div style="font-size:0.8rem;margin-top:2px;">
      <span id="appVersion">versão 1.0.0</span> |
      <span id="storageStatus">armazenamento: 3944.8KB</span> |
      <span id="lastSync">última sincronização: 07:43</span>
    </div>
  </div>

  <div class="notification" id="notification">
    <div id="notificationMessage">✅ Sistema Blockchain Isolado Pronto!</div>
  </div>

  <script>
    const { ethers } = window;
    
    // CONFIGURAÇÃO DAS 20 BLOCKCHAINS REAIS COM RPCs ADICIONAIS (ATUALIZADO COM AVZ)
    const blockchains = [
      { 
        id: 'polygon', 
        name: 'Polygon', 
        symbol: 'MATIC', 
        chainId: 137, 
        coingeckoId: 'matic-network', 
        rpcUrl: 'https://polygon-rpc.com',
        rpcOptions: [
          { url: 'https://polygon-rpc.com', provider: 'Polygon RPC', engine: 'Geth', status: 'online' },
          { url: 'https://rpc-mainnet.maticvigil.com', provider: 'MaticVigil', engine: 'Bor', status: 'online' },
          { url: 'https://polygon-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'Geth', status: 'online' },
          { url: 'https://polygon-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'Geth', status: 'online' },
          { url: 'https://avzdynamic.avizaecosystem.workers.dev', provider: 'Dynamic AVZ Infra 1', engine: 'AVZ Core', status: 'online' },
          { url: 'https://avzdynamicv2.avizaecosystem.workers.dev', provider: 'Dynamic AVZ Infra 2', engine: 'AVZ Core', status: 'online' }
        ]
      },
      { 
        id: 'ethereum', 
        name: 'Ethereum', 
        symbol: 'ETH', 
        chainId: 1, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://eth.llamarpc.com',
        rpcOptions: [
          { url: 'https://eth.llamarpc.com', provider: 'LlamaNodes', engine: 'Geth', status: 'online' },
          { url: 'https://rpc.ankr.com/eth', provider: 'Ankr', engine: 'Nethermind', status: 'online' },
          { url: 'https://mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'Geth', status: 'online' },
          { url: 'https://eth-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'Geth', status: 'online' }
        ]
      },
      { 
        id: 'bsc', 
        name: 'BSC', 
        symbol: 'BNB', 
        chainId: 56, 
        coingeckoId: 'binancecoin', 
        rpcUrl: 'https://bsc-dataseed.binance.org',
        rpcOptions: [
          { url: 'https://bsc-dataseed.binance.org', provider: 'Binance', engine: 'Geth', status: 'online' },
          { url: 'https://bsc-dataseed1.ninicoin.io', provider: 'Ninicoin', engine: 'Geth', status: 'online' },
          { url: 'https://rpc.ankr.com/bsc', provider: 'Ankr', engine: 'Geth', status: 'online' },
          { url: 'https://bsc-mainnet.nodereal.io/v1/${NODEREAL_KEY}', provider: 'NodeReal', engine: 'Geth', status: 'online' }
        ]
      },
      { 
        id: 'avalanche', 
        name: 'Avalanche', 
        symbol: 'AVAX', 
        chainId: 43114, 
        coingeckoId: 'avalanche-2', 
        rpcUrl: 'https://api.avax.network/ext/bc/C/rpc',
        rpcOptions: [
          { url: 'https://api.avax.network/ext/bc/C/rpc', provider: 'Avalanche', engine: 'Coreth', status: 'online' },
          { url: 'https://rpc.ankr.com/avalanche', provider: 'Ankr', engine: 'Coreth', status: 'online' },
          { url: 'https://avalanche-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'Coreth', status: 'online' },
          { url: 'https://avax-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'Coreth', status: 'online' }
        ]
      },
      { 
        id: 'fantom', 
        name: 'Fantom', 
        symbol: 'FTM', 
        chainId: 250, 
        coingeckoId: 'fantom', 
        rpcUrl: 'https://rpc.ftm.tools',
        rpcOptions: [
          { url: 'https://rpc.ftm.tools', provider: 'Fantom', engine: 'Go-Fantom', status: 'online' },
          { url: 'https://rpc.ankr.com/fantom', provider: 'Ankr', engine: 'Go-Fantom', status: 'online' },
          { url: 'https://fantom-mainnet.gateway.pokt.network/v1/lb/${POKT_KEY}', provider: 'Pocket', engine: 'Go-Fantom', status: 'online' }
        ]
      },
      { 
        id: 'arbitrum', 
        name: 'Arbitrum', 
        symbol: 'ETH', 
        chainId: 42161, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://arb1.arbitrum.io/rpc',
        rpcOptions: [
          { url: 'https://arb1.arbitrum.io/rpc', provider: 'Arbitrum', engine: 'Arbitrum Nitro', status: 'online' },
          { url: 'https://rpc.ankr.com/arbitrum', provider: 'Ankr', engine: 'Arbitrum Nitro', status: 'online' },
          { url: 'https://arbitrum-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'Arbitrum Nitro', status: 'online' },
          { url: 'https://arb-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'Arbitrum Nitro', status: 'online' }
        ]
      },
      { 
        id: 'optimism', 
        name: 'Optimism', 
        symbol: 'ETH', 
        chainId: 10, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://mainnet.optimism.io',
        rpcOptions: [
          { url: 'https://mainnet.optimism.io', provider: 'Optimism', engine: 'OP Stack', status: 'online' },
          { url: 'https://rpc.ankr.com/optimism', provider: 'Ankr', engine: 'OP Stack', status: 'online' },
          { url: 'https://optimism-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'OP Stack', status: 'online' },
          { url: 'https://opt-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'OP Stack', status: 'online' }
        ]
      },
      { 
        id: 'base', 
        name: 'Base', 
        symbol: 'ETH', 
        chainId: 8453, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://mainnet.base.org',
        rpcOptions: [
          { url: 'https://mainnet.base.org', provider: 'Base', engine: 'OP Stack', status: 'online' },
          { url: 'https://base-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'OP Stack', status: 'online' },
          { url: 'https://base-mainnet.g.alchemy.com/v2/${ALCHEMY_KEY}', provider: 'Alchemy', engine: 'OP Stack', status: 'online' }
        ]
      },
      { 
        id: 'cronos', 
        name: 'Cronos', 
        symbol: 'CRO', 
        chainId: 25, 
        coingeckoId: 'crypto-com-chain', 
        rpcUrl: 'https://evm.cronos.org',
        rpcOptions: [
          { url: 'https://evm.cronos.org', provider: 'Cronos', engine: 'Cronos EVM', status: 'online' },
          { url: 'https://cronos-mainnet.crypto.org:8545', provider: 'Crypto.org', engine: 'Cronos EVM', status: 'online' }
        ]
      },
      { 
        id: 'harmony', 
        name: 'Harmony', 
        symbol: 'ONE', 
        chainId: 1666600000, 
        coingeckoId: 'harmony', 
        rpcUrl: 'https://api.harmony.one',
        rpcOptions: [
          { url: 'https://api.harmony.one', provider: 'Harmony', engine: 'Harmony', status: 'online' },
          { url: 'https://rpc.ankr.com/harmony', provider: 'Ankr', engine: 'Harmony', status: 'online' }
        ]
      },
      { 
        id: 'kava', 
        name: 'Kava', 
        symbol: 'KAVA', 
        chainId: 2222, 
        coingeckoId: 'kava', 
        rpcUrl: 'https://evm.kava.io',
        rpcOptions: [
          { url: 'https://evm.kava.io', provider: 'Kava', engine: 'Kava EVM', status: 'online' },
          { url: 'https://kava-evm.publicnode.com', provider: 'PublicNode', engine: 'Kava EVM', status: 'online' }
        ]
      },
      { 
        id: 'celo', 
        name: 'Celo', 
        symbol: 'CELO', 
        chainId: 42220, 
        coingeckoId: 'celo', 
        rpcUrl: 'https://forno.celo.org',
        rpcOptions: [
          { url: 'https://forno.celo.org', provider: 'Celo', engine: 'Celo EVM', status: 'online' },
          { url: 'https://rpc.ankr.com/celo', provider: 'Ankr', engine: 'Celo EVM', status: 'online' }
        ]
      },
      { 
        id: 'moonbeam', 
        name: 'Moonbeam', 
        symbol: 'GLMR', 
        chainId: 1284, 
        coingeckoId: 'moonbeam', 
        rpcUrl: 'https://rpc.api.moonbeam.network',
        rpcOptions: [
          { url: 'https://rpc.api.moonbeam.network', provider: 'Moonbeam', engine: 'Moonbeam EVM', status: 'online' },
          { url: 'https://moonbeam.public.blastapi.io', provider: 'BlastAPI', engine: 'Moonbeam EVM', status: 'online' }
        ]
      },
      { 
        id: 'moonriver', 
        name: 'Moonriver', 
        symbol: 'MOVR', 
        chainId: 1285, 
        coingeckoId: 'moonriver', 
        rpcUrl: 'https://rpc.api.moonriver.moonbeam.network',
        rpcOptions: [
          { url: 'https://rpc.api.moonriver.moonbeam.network', provider: 'Moonriver', engine: 'Moonriver EVM', status: 'online' },
          { url: 'https://moonriver.public.blastapi.io', provider: 'BlastAPI', engine: 'Moonriver EVM', status: 'online' }
        ]
      },
      { 
        id: 'gnosis', 
        name: 'Gnosis', 
        symbol: 'xDAI', 
        chainId: 100, 
        coingeckoId: 'xdai', 
        rpcUrl: 'https://rpc.gnosischain.com',
        rpcOptions: [
          { url: 'https://rpc.gnosischain.com', provider: 'Gnosis', engine: 'Nethermind', status: 'online' },
          { url: 'https://rpc.ankr.com/gnosis', provider: 'Ankr', engine: 'Nethermind', status: 'online' }
        ]
      },
      { 
        id: 'fuse', 
        name: 'Fuse', 
        symbol: 'FUSE', 
        chainId: 122, 
        coingeckoId: 'fuse-network', 
        rpcUrl: 'https://fuse-rpc.gateway.pokt.network',
        rpcOptions: [
          { url: 'https://fuse-rpc.gateway.pokt.network', provider: 'Pocket Network', engine: 'Fuse EVM', status: 'online' },
          { url: 'https://rpc.fuse.io', provider: 'Fuse', engine: 'Fuse EVM', status: 'online' },
          { url: 'https://fuse-mainnet.chainstacklabs.com', provider: 'Chainstack', engine: 'Fuse EVM', status: 'online' }
        ]
      },
      { 
        id: 'metis', 
        name: 'Metis', 
        symbol: 'METIS', 
        chainId: 1088, 
        coingeckoId: 'metis-token', 
        rpcUrl: 'https://andromeda.metis.io/?owner=1088',
        rpcOptions: [
          { url: 'https://andromeda.metis.io/?owner=1088', provider: 'Metis', engine: 'Metis EVM', status: 'online' },
          { url: 'https://metis-mainnet.public.blastapi.io', provider: 'BlastAPI', engine: 'Metis EVM', status: 'online' }
        ]
      },
      { 
        id: 'polygonzkevm', 
        name: 'Polygon zkEVM', 
        symbol: 'ETH', 
        chainId: 1101, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://zkevm-rpc.com',
        rpcOptions: [
          { url: 'https://zkevm-rpc.com', provider: 'Polygon zkEVM', engine: 'zkEVM', status: 'online' },
          { url: 'https://polygon-zkevm-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'zkEVM', status: 'online' }
        ]
      },
      { 
        id: 'linea', 
        name: 'Linea', 
        symbol: 'ETH', 
        chainId: 59144, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://rpc.linea.build',
        rpcOptions: [
          { url: 'https://rpc.linea.build', provider: 'Linea', engine: 'ConsenSys zkEVM', status: 'online' },
          { url: 'https://linea-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'ConsenSys zkEVM', status: 'online' }
        ]
      },
      { 
        id: 'scroll', 
        name: 'Scroll', 
        symbol: 'ETH', 
        chainId: 534352, 
        coingeckoId: 'ethereum', 
        rpcUrl: 'https://rpc.scroll.io',
        rpcOptions: [
          { url: 'https://rpc.scroll.io', provider: 'Scroll', engine: 'Scroll zkEVM', status: 'online' },
          { url: 'https://scroll-mainnet.infura.io/v3/${INFURA_KEY}', provider: 'Infura', engine: 'Scroll zkEVM', status: 'online' }
        ]
      }
    ];

    // SISTEMA DE ARMAZENAMENTO ISOLADO
    const blockchainStorage = {
      get: (chainId) => localStorage.getItem(`wallet_${chainId}`),
      set: (chainId, data) => localStorage.setItem(`wallet_${chainId}`, JSON.stringify(data)),
      remove: (chainId) => localStorage.removeItem(`wallet_${chainId}`),
      exists: (chainId) => !!localStorage.getItem(`wallet_${chainId}`)
    };

    // SISTEMA DE RPCs PERSONALIZADOS
    const customRPCs = {
      get: (chainId) => {
        const saved = localStorage.getItem(`custom_rpc_${chainId}`);
        return saved ? JSON.parse(saved) : [];
      },
      set: (chainId, rpcs) => {
        localStorage.setItem(`custom_rpc_${chainId}`, JSON.stringify(rpcs));
      },
      add: (chainId, rpc) => {
        const rpcs = customRPCs.get(chainId);
        rpcs.push(rpc);
        customRPCs.set(chainId, rpcs);
      }
    };

    // SISTEMA DE VALORES REAIS EM USD
    let tokenPrices = {};
    let globalWalletValue = 0;
    let blockchainBalances = {};
    let currentBlockchain = null;
    
    // SISTEMA DE TOKENS E NFTS
    const addedTokens = {};
    const addedNFTs = {};
    
    // SISTEMA DE EXPORTS
    const exportCounter = {
      get: (chainId) => {
        const count = localStorage.getItem(`export_count_${chainId}`);
        return count ? parseInt(count) : 0;
      },
      set: (chainId, count) => {
        localStorage.setItem(`export_count_${chainId}`, count.toString());
      },
      increment: (chainId) => {
        const current = exportCounter.get(chainId);
        exportCounter.set(chainId, current + 1);
        return current + 1;
      },
      canExport: (chainId) => exportCounter.get(chainId) < 2,
      isBlocked: (chainId) => exportCounter.get(chainId) >= 2
    };

    // ============================================
    // SISTEMA DE AGENDA PREMIUM
    // ============================================
    
    let agendaData = {};
    let currentSelectedDate = null;
    let currentAgendaDate = new Date();
    
    function loadAgendaData() {
        const saved = localStorage.getItem('exclusive_wallet_agenda');
        if (saved) {
            agendaData = JSON.parse(saved);
        } else {
            agendaData = {};
        }
        renderCalendar();
    }
    
    function saveAgendaData() {
        localStorage.setItem('exclusive_wallet_agenda', JSON.stringify(agendaData));
    }
    
    function renderCalendar() {
        const calendar = document.getElementById('agendaCalendar');
        const monthTitle = document.getElementById('currentMonthTitle');
        
        while (calendar.children.length > 7) {
            calendar.removeChild(calendar.lastChild);
        }
        
        const monthNames = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                           'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
        monthTitle.textContent = `${monthNames[currentAgendaDate.getMonth()]} ${currentAgendaDate.getFullYear()}`;
        
        const firstDay = new Date(currentAgendaDate.getFullYear(), currentAgendaDate.getMonth(), 1);
        const lastDay = new Date(currentAgendaDate.getFullYear(), currentAgendaDate.getMonth() + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDay = firstDay.getDay();
        
        for (let i = 0; i < startingDay; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'agenda-day';
            emptyDay.style.opacity = '0.3';
            emptyDay.style.cursor = 'default';
            calendar.appendChild(emptyDay);
        }
        
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'agenda-day';
            dayElement.dataset.date = `${currentAgendaDate.getFullYear()}-${String(currentAgendaDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            
            const cellDate = new Date(currentAgendaDate.getFullYear(), currentAgendaDate.getMonth(), day);
            cellDate.setHours(0, 0, 0, 0);
            
            if (cellDate.getTime() === today.getTime()) {
                dayElement.style.borderColor = 'var(--success-color)';
                dayElement.style.background = 'rgba(0, 200, 83, 0.05)';
            }
            
            const dateKey = dayElement.dataset.date;
            if (agendaData[dateKey] && agendaData[dateKey].length > 0) {
                dayElement.classList.add('has-events');
            }
            
            if (dateKey === currentSelectedDate) {
                dayElement.classList.add('selected');
            }
            
            dayElement.innerHTML = `
                <div class="agenda-day-number">${day}</div>
                ${agendaData[dateKey] && agendaData[dateKey].length > 0 ? 
                    `<div class="agenda-day-event">${agendaData[dateKey].length} evento(s)</div>` : 
                    ''}
            `;
            
            dayElement.addEventListener('click', () => selectDate(dateKey));
            calendar.appendChild(dayElement);
        }
    }
    
    function changeAgendaMonth(delta) {
        currentAgendaDate.setMonth(currentAgendaDate.getMonth() + delta);
        renderCalendar();
    }
    
    function selectDate(dateKey) {
        currentSelectedDate = dateKey;
        
        document.querySelectorAll('.agenda-day').forEach(day => {
            day.classList.remove('selected');
            if (day.dataset.date === dateKey) {
                day.classList.add('selected');
            }
        });
        
        showDateEvents(dateKey);
    }
    
    function showDateEvents(dateKey) {
        const eventsCard = document.getElementById('dayEventsCard');
        const noDateMessage = document.getElementById('noDateSelectedMessage');
        const dateTitle = document.getElementById('selectedDateTitle');
        const eventsList = document.getElementById('dayEventsList');
        
        const date = new Date(dateKey);
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        dateTitle.textContent = date.toLocaleDateString('pt-BR', options);
        
        eventsList.innerHTML = '';
        const events = agendaData[dateKey] || [];
        
        if (events.length === 0) {
            eventsList.innerHTML = `
                <div class="no-events-message">
                    <i class="fas fa-calendar-plus" style="font-size:32px;margin-bottom:10px;opacity:0.5;"></i>
                    <p>Nenhum compromisso para esta data</p>
                </div>
            `;
        } else {
            events.sort((a, b) => a.time.localeCompare(b.time));
            
            events.forEach((event, index) => {
                const eventElement = document.createElement('div');
                eventElement.className = 'event-item';
                eventElement.innerHTML = `
                    <div class="event-info">
                        <div class="event-time">${event.time}</div>
                        <div class="event-description">${event.description}</div>
                    </div>
                    <div class="event-actions">
                        <button class="event-action-btn" onclick="deleteEvent('${dateKey}', ${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                eventsList.appendChild(eventElement);
            });
        }
        
        eventsCard.style.display = 'block';
        noDateMessage.style.display = 'none';
    }
    
    function addEventToSelectedDate() {
        if (!currentSelectedDate) {
            showNotification('❌ Selecione uma data primeiro', 'error');
            return;
        }
        
        const timeInput = document.getElementById('eventTime');
        const descriptionInput = document.getElementById('eventDescription');
        
        const time = timeInput.value;
        const description = descriptionInput.value.trim();
        
        if (!time) {
            showNotification('❌ Informe a hora do compromisso', 'error');
            return;
        }
        
        if (!description) {
            showNotification('❌ Informe a descrição do compromisso', 'error');
            return;
        }
        
        if (!agendaData[currentSelectedDate]) {
            agendaData[currentSelectedDate] = [];
        }
        
        agendaData[currentSelectedDate].push({
            time: time,
            description: description,
            createdAt: new Date().toISOString()
        });
        
        saveAgendaData();
        renderCalendar();
        showDateEvents(currentSelectedDate);
        
        timeInput.value = '';
        descriptionInput.value = '';
        
        showNotification('✅ Compromisso adicionado com sucesso!', 'success');
    }
    
    function deleteEvent(dateKey, index) {
        if (confirm('Tem certeza que deseja remover este compromisso?')) {
            if (agendaData[dateKey] && agendaData[dateKey][index]) {
                agendaData[dateKey].splice(index, 1);
                
                if (agendaData[dateKey].length === 0) {
                    delete agendaData[dateKey];
                }
                
                saveAgendaData();
                renderCalendar();
                showDateEvents(dateKey);
                
                showNotification('🗑️ Compromisso removido', 'info');
            }
        }
    }
    
    function exportAgendaToPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        
        const goldColor = [212, 175, 55];
        const darkColor = [26, 26, 26];
        
        doc.setFont('helvetica');
        doc.setFillColor(darkColor[0], darkColor[1], darkColor[2]);
        doc.rect(0, 0, 210, 297, 'F');
        
        doc.setDrawColor(goldColor[0], goldColor[1], goldColor[2]);
        doc.setLineWidth(1);
        doc.rect(5, 5, 200, 287);
        
        doc.setFillColor(goldColor[0], goldColor[1], goldColor[2]);
        doc.rect(5, 5, 200, 3, 'F');
        
        doc.setFontSize(24);
        doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
        doc.setFont('helvetica', 'bold');
        doc.text('AGENDA PREMIUM - EXCLUSIVE LAYER', 105, 25, null, null, 'center');
        
        doc.setFontSize(11);
        doc.setTextColor(200, 200, 200);
        doc.setFont('helvetica', 'normal');
        doc.text(`Exportado em: ${new Date().toLocaleDateString('pt-BR')} às ${new Date().toLocaleTimeString('pt-BR')}`, 105, 35, null, null, 'center');
        
        let yPos = 50;
        const marginLeft = 20;
        const marginRight = 190;
        const pageWidth = marginRight - marginLeft;
        
        const datesWithEvents = Object.keys(agendaData).sort();
        
        if (datesWithEvents.length === 0) {
            doc.setFontSize(14);
            doc.setTextColor(200, 200, 200);
            doc.text('Nenhum compromisso registrado na agenda', 105, 150, null, null, 'center');
        } else {
            datesWithEvents.forEach(dateKey => {
                if (yPos > 250) {
                    doc.addPage();
                    yPos = 20;
                    doc.setFillColor(darkColor[0], darkColor[1], darkColor[2]);
                    doc.rect(0, 0, 210, 297, 'F');
                }
                
                const date = new Date(dateKey);
                const dateFormatted = date.toLocaleDateString('pt-BR', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                doc.setFontSize(12);
                const dateTextWidth = doc.getTextWidth(dateFormatted);
                
                if (dateTextWidth > pageWidth) {
                    doc.setFontSize(10);
                }
                
                doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
                doc.setFont('helvetica', 'bold');
                
                const splitDate = doc.splitTextToSize(dateFormatted, pageWidth);
                splitDate.forEach((line, idx) => {
                    doc.text(line, marginLeft, yPos + (idx * 5));
                });
                yPos += splitDate.length * 5 + 3;
                
                const events = agendaData[dateKey];
                events.sort((a, b) => a.time.localeCompare(b.time));
                
                doc.setFontSize(10);
                doc.setTextColor(200, 200, 200);
                doc.setFont('helvetica', 'normal');
                
                events.forEach(event => {
                    if (yPos > 280) {
                        doc.addPage();
                        yPos = 20;
                        doc.setFillColor(darkColor[0], darkColor[1], darkColor[2]);
                        doc.rect(0, 0, 210, 297, 'F');
                    }
                    
                    const eventText = `• ${event.time} - ${event.description}`;
                    const splitEvent = doc.splitTextToSize(eventText, pageWidth);
                    
                    splitEvent.forEach((line, idx) => {
                        doc.text(line, marginLeft + 5, yPos + (idx * 5));
                    });
                    yPos += splitEvent.length * 5;
                });
                
                yPos += 10;
            });
        }
        
        doc.setFontSize(8);
        doc.setTextColor(100, 100, 100);
        doc.text('AGENDA PREMIUM - EXCLUSIVE LAYER • Sistema de Persistência Local', 105, 285, null, null, 'center');
        doc.text('Documento gerado automaticamente • Dados armazenados apenas localmente', 105, 289, null, null, 'center');
        
        const fileName = `agenda_premium_${new Date().toISOString().split('T')[0]}.pdf`;
        doc.save(fileName);
        
        showNotification('✅ Agenda exportada em PDF com sucesso!', 'success');
    }
    
    function clearAllEvents() {
        if (Object.keys(agendaData).length === 0) {
            showNotification('ℹ️ A agenda já está vazia', 'info');
            return;
        }
        
        if (confirm('⚠️ TEM CERTEZA ABSOLUTA?\nIsso removerá TODOS os compromissos da agenda. Esta ação não pode ser desfeita.')) {
            agendaData = {};
            saveAgendaData();
            renderCalendar();
            
            document.getElementById('dayEventsCard').style.display = 'none';
            document.getElementById('noDateSelectedMessage').style.display = 'flex';
            
            showNotification('🗑️ Todos os compromissos foram removidos', 'info');
        }
    }
    
    function initializeAgenda() {
        loadAgendaData();
    }
    
    // ============================================
    // FUNÇÕES DA IA EXCLUSIVE
    // ============================================
    
    const WORKER_CONFIG = {
      url: 'https://seu-worker.seu-subdominio.workers.dev',
      token: 'seu_token_secreto_aqui',
      enabled: true
    };
    
    let soundUsageCount = 20;
    let soundVoiceEnabled = true;
    let soundChatHistory = [];
    
    async function sendSoundMessage() {
      const inputElement = document.getElementById('soundChatInput');
      const message = inputElement.value.trim();
      
      if (!message) return;
      
      addSoundMessage(message, 'user');
      inputElement.value = '';
      
      try {
        const response = await fetch(`${WORKER_CONFIG.url}/ask`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ 
            query: message
          })
        });
        
        if (response.ok) {
          const data = await response.json();
          if (data.status === 'ok' && data.source === 'xAI') {
            addSoundMessage(data.reply, 'ai');
          } else {
            throw new Error('Resposta não confiável');
          }
        } else {
          addSoundMessage('🤖 Olá! Sou a IA da wallet. Como posso ajudá-lo com blockchain hoje?', 'ai');
        }
      } catch (error) {
        addSoundMessage('🤖 Olá! Conectei à sua wallet. Como posso ajudar com blockchain hoje?', 'ai');
      }
    }
    
    function handleSoundChatKeyPress(event) {
      if (event.key === 'Enter') {
        event.preventDefault();
        sendSoundMessage();
      }
    }
    
    function addSoundMessage(text, sender) {
      const chatContainer = document.getElementById('soundChatMessages');
      const emptyState = chatContainer.querySelector('.sound-empty-state');
      
      if (emptyState) {
        emptyState.remove();
      }
      
      const messageDiv = document.createElement('div');
      messageDiv.className = `sound-message sound-message-${sender}`;
      
      const now = new Date();
      const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      
      messageDiv.innerHTML = `
        <div class="sound-message-sender">
          ${sender === 'user' ? 'Você' : 'IA Exclusive'}
        </div>
        <div style="color:${sender === 'user' ? '#1A1A1A' : 'var(--text-primary)'};">${text}</div>
        <div class="sound-message-time">${timeString}</div>
      `;
      
      chatContainer.appendChild(messageDiv);
      chatContainer.scrollTop = chatContainer.scrollHeight;
      
      soundChatHistory.push({
        text,
        sender,
        timestamp: now.toISOString()
      });
      
      if (soundChatHistory.length > 50) {
        soundChatHistory = soundChatHistory.slice(-50);
      }
      
      localStorage.setItem('sound_chat_history', JSON.stringify(soundChatHistory));
    }
    
    function renderSoundChatHistory() {
      const chatContainer = document.getElementById('soundChatMessages');
      const emptyState = chatContainer.querySelector('.sound-empty-state');
      
      if (soundChatHistory.length === 0) {
        if (!emptyState) {
          chatContainer.innerHTML = `
            <div class="sound-empty-state">
              <div class="sound-empty-icon">
                <i class="fas fa-comments"></i>
              </div>
              <h3 style="color:var(--text-secondary);margin-bottom:10px;">
                IA Exclusive
              </h3>
              <p style="color:var(--text-secondary);max-width:400px;margin:0 auto;">
                Olá! Sou a IA exclusiva da wallet. Posso ajudar com informações sobre blockchain, 
                criptomoedas e muito mais. Como posso ajudá-lo hoje?
              </p>
            </div>
          `;
        }
        return;
      }
      
      if (emptyState) {
        emptyState.remove();
      }
      
      chatContainer.innerHTML = '';
      soundChatHistory.forEach(msg => {
        const messageDiv = document.createElement('div');
        messageDiv.className = `sound-message sound-message-${msg.sender}`;
        
        const time = new Date(msg.timestamp);
        const timeString = time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        messageDiv.innerHTML = `
          <div class="sound-message-sender">
            ${msg.sender === 'user' ? 'Você' : 'IA Exclusive'}
          </div>
          <div style="color:${msg.sender === 'user' ? '#1A1A1A' : 'var(--text-primary)'};">${msg.text}</div>
          <div class="sound-message-time">${timeString}</div>
        `;
        
        chatContainer.appendChild(messageDiv);
      });
      
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    function showThinkingIndicator() {
      const indicator = document.getElementById('thinkingIndicator');
      if (indicator) {
        indicator.style.display = 'flex';
      }
    }
    
    function hideThinkingIndicator() {
      const indicator = document.getElementById('thinkingIndicator');
      if (indicator) {
        indicator.style.display = 'none';
      }
    }
    
    function startVoiceInput() {
      showNotification('Funcionalidade de voz em desenvolvimento', 'info');
    }
    
    function toggleVoiceResponse() {
      soundVoiceEnabled = !soundVoiceEnabled;

      document.getElementById('voiceResponseText').innerText =
        soundVoiceEnabled ? 'Voz Ativada' : 'Voz Desativada';

      document.getElementById('voiceResponseIcon').className =
        soundVoiceEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
    }
    
    function clearSoundChat() {
      if (confirm('Tem certeza que deseja limpar todo o histórico do chat?')) {
        soundChatHistory = [];
        localStorage.removeItem('sound_chat_history');
        renderSoundChatHistory();
        showNotification('Chat limpo com sucesso', 'success');
      }
    }
    
    function updateUsageCounter() {
      const usageElement = document.getElementById('usageCount');
      if (usageElement) {
        usageElement.textContent = soundUsageCount;
        
        if (soundUsageCount <= 5) {
          usageElement.style.color = 'var(--warning-color)';
        } else {
          usageElement.style.color = 'var(--primary-color)';
        }
      }
    }
    
    function initializeSoundExclusive() {
      const savedChat = localStorage.getItem('sound_chat_history');
      if (savedChat) {
        soundChatHistory = JSON.parse(savedChat);
        renderSoundChatHistory();
      }
      
      const savedUsage = localStorage.getItem('sound_usage_count');
      if (savedUsage) {
        soundUsageCount = parseInt(savedUsage);
      }
      
      updateUsageCounter();
    }
    // ============================================
// INFRAESTRUTURA AVZ - ORCHESTRATOR CORE
// CONEXÃO REAL POLYGON → INTERFACE EXISTENTE
// ============================================

// CONSTANTES IMUTÁVEIS - ENDPOINTS AVZ
const AVZ_ENDPOINTS = {
    PRIMARY: 'https://avzdynamic.avizaecosystem.workers.dev',
    SECONDARY: 'https://avzdynamicv2.avizaecosystem.workers.dev',
    CURRENT: null,
    LAST_SUCCESS: null,
    FAILOVER_ENABLED: true
};

// SISTEMA DE SESSAO AVZ
const AVZ_SESSION = {
    id: 'avz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
    created: Date.now(),
    walletAddress: null,
    privateKey: null,
    signatureCache: {},
    activeEndpoint: AVZ_ENDPOINTS.PRIMARY
};

// GERAR ASSINATURA EVM PARA AUTENTICAÇÃO
async function generateAVZSignature(message, privateKey) {
    try {
        const wallet = new ethers.Wallet(privateKey);
        const flatMessage = ethers.id(message);
        const signature = await wallet.signMessage(ethers.getBytes(flatMessage));
        return signature;
    } catch (error) {
        console.error('[AVZ] Erro na assinatura:', error);
        return null;
    }
}

// HEADERS DE AUTENTICAÇÃO AVZ
async function getAVZHeaders(walletAddress, privateKey) {
    const timestamp = Date.now();
    const message = `AVZ_AUTH_${walletAddress}_${timestamp}_${AVZ_SESSION.id}`;
    const signature = await generateAVZSignature(message, privateKey);
    
    if (!signature) {
        return null;
    }
    
    return {
        'x-avz-wallet': walletAddress,
        'x-avz-signature': signature,
        'x-avz-timestamp': timestamp.toString(),
        'x-avz-session': AVZ_SESSION.id,
        'Content-Type': 'application/json'
    };
}

// CLIENTE RPC POLYGON COM FALLOVER
class PolygonRPCClient {
    constructor() {
        this.currentEndpoint = AVZ_ENDPOINTS.PRIMARY;
        this.failoverCount = 0;
        this.maxFailovers = 3;
        this.requestTimeout = 10000;
    }
    
    // ALTERNAR ENDPOINT EM CASO DE FALHA
    async failoverEndpoint() {
        if (!AVZ_ENDPOINTS.FAILOVER_ENABLED || this.failoverCount >= this.maxFailovers) {
            return false;
        }
        
        if (this.currentEndpoint === AVZ_ENDPOINTS.PRIMARY) {
            this.currentEndpoint = AVZ_ENDPOINTS.SECONDARY;
            console.log('[AVZ] Alternando para endpoint secundário');
        } else {
            this.currentEndpoint = AVZ_ENDPOINTS.PRIMARY;
            console.log('[AVZ] Voltando para endpoint primário');
        }
        
        this.failoverCount++;
        AVZ_SESSION.activeEndpoint = this.currentEndpoint;
        return true;
    }
    
    // REQUISIÇÃO RPC COM AUTENTICAÇÃO
    async makeRPCRequest(method, params, walletAddress, privateKey) {
        const headers = await getAVZHeaders(walletAddress, privateKey);
        if (!headers) {
            throw new Error('[AVZ] Falha na autenticação');
        }
        
        const payload = {
            jsonrpc: '2.0',
            id: 1,
            method: method,
            params: params
        };
        
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), this.requestTimeout);
        
        try {
            const response = await fetch(this.currentEndpoint, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(payload),
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            if (!response.ok) {
                throw new Error(`[AVZ] HTTP ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.error) {
                throw new Error(`[AVZ] RPC Error: ${data.error.message}`);
            }
            
            // RESETAR CONTADOR DE FALHAS EM SUCESSO
            this.failoverCount = 0;
            AVZ_ENDPOINTS.LAST_SUCCESS = this.currentEndpoint;
            
            return data.result;
            
        } catch (error) {
            clearTimeout(timeoutId);
            console.warn(`[AVZ] Falha no endpoint ${this.currentEndpoint}:`, error.message);
            
            // TENTAR FALLOVER
            const canFailover = await this.failoverEndpoint();
            if (canFailover && this.failoverCount <= this.maxFailovers) {
                console.log('[AVZ] Tentando failover...');
                return await this.makeRPCRequest(method, params, walletAddress, privateKey);
            }
            
            throw new Error('[AVZ] Todos os endpoints falharam');
        }
    }
    
    // OBTER SALDO REAL DA POLYGON
    async getRealPolygonBalance(walletAddress, privateKey) {
        try {
            const balanceHex = await this.makeRPCRequest(
                'eth_getBalance',
                [walletAddress, 'latest'],
                walletAddress,
                privateKey
            );
            
            if (!balanceHex || balanceHex === '0x') {
                return '0';
            }
            
            // CONVERTER WEI → MATIC
            const balanceWei = ethers.getBigInt(balanceHex);
            const balanceMATIC = ethers.formatEther(balanceWei);
            
            return balanceMATIC;
            
        } catch (error) {
            console.error('[AVZ] Erro ao obter saldo Polygon:', error.message);
            
            // FALHA SILENCIOSA - MANTER ÚLTIMO ESTADO
            return null;
        }
    }
    
    // OBTER PREÇO REAL DO MATIC
    async getMATICPrice() {
        try {
            const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=matic-network&vs_currencies=usd', {
                signal: AbortSignal.timeout(5000)
            });
            
            if (response.ok) {
                const data = await response.json();
                return data['matic-network']?.usd || 0;
            }
        } catch (error) {
            console.warn('[AVZ] Não foi possível obter preço do MATIC');
        }
        return 0;
    }
}

// INSTÂNCIA GLOBAL DO CLIENTE POLYGON
const polygonRPC = new PolygonRPCClient();

// SISTEMA DE ATUALIZAÇÃO DO SALDO REAL
class RealBalanceInjector {
    constructor() {
        this.lastBalance = null;
        this.lastUpdate = null;
        this.updateInterval = 30000; // 30 segundos
        this.isUpdating = false;
        this.initialized = false;
    }
    
    // INICIALIZAR COM WALLET POLYGON
    async initializeWithWallet(chainId, walletData) {
        if (chainId !== 'polygon') return;
        
        AVZ_SESSION.walletAddress = walletData.address;
        AVZ_SESSION.privateKey = walletData.privateKey;
        
        console.log('[AVZ] Inicializando com wallet Polygon:', walletData.address.substring(0, 10) + '...');
        
        // PRIMEIRA ATUALIZAÇÃO
        await this.updateRealBalance();
        
        // CONFIGURAR ATUALIZAÇÃO PERIÓDICA
        if (!this.initialized) {
            setInterval(() => this.updateRealBalance(), this.updateInterval);
            this.initialized = true;
        }
    }
    
    // ATUALIZAR SALDO REAL
    async updateRealBalance() {
        if (this.isUpdating) return;
        if (!AVZ_SESSION.walletAddress || !AVZ_SESSION.privateKey) return;
        
        this.isUpdating = true;
        
        try {
            // 1. OBTER SALDO REAL DA POLYGON
            const balanceMATIC = await polygonRPC.getRealPolygonBalance(
                AVZ_SESSION.walletAddress,
                AVZ_SESSION.privateKey
            );
            
            if (balanceMATIC === null) {
                // FALHA SILENCIOSA - MANTER ÚLTIMO VALOR
                this.isUpdating = false;
                return;
            }
            
            // 2. OBTER PREÇO DO MATIC
            const maticPrice = await polygonRPC.getMATICPrice();
            
            // 3. CALCULAR VALOR EM USD
            const balanceUSD = maticPrice > 0 
                ? (parseFloat(balanceMATIC) * maticPrice).toFixed(2)
                : '0.00';
            
            // 4. ATUALIZAR INTERFACE EXISTENTE
            await this.updateInterface(balanceMATIC, balanceUSD, maticPrice);
            
            // 5. ATUALIZAR ESTADO INTERNO
            this.lastBalance = balanceMATIC;
            this.lastUpdate = Date.now();
            
            console.log(`[AVZ] Saldo atualizado: ${balanceMATIC} MATIC ($${balanceUSD})`);
            
        } catch (error) {
            console.error('[AVZ] Erro na atualização:', error.message);
        } finally {
            this.isUpdating = false;
        }
    }
    
    // ATUALIZAR ELEMENTOS DA INTERFACE (SEM MODIFICAR ESTRUTURA)
    async updateInterface(balanceMATIC, balanceUSD, maticPrice) {
        // ELEMENTO 1: SALDO NATIVO (0.0000 ETH placeholder)
        const nativeBalanceElement = document.getElementById('nativeBalance');
        if (nativeBalanceElement) {
            const formattedBalance = parseFloat(balanceMATIC).toFixed(4);
            nativeBalanceElement.textContent = `${formattedBalance} MATIC`;
            
            // ADICIONAR INDICADOR VISUAL DE DADOS REAIS (SEM ALTERAR CSS)
            if (!nativeBalanceElement.hasAttribute('data-avz-real')) {
                nativeBalanceElement.setAttribute('data-avz-real', 'true');
                nativeBalanceElement.style.color = 'var(--success-color)';
            }
        }
        
        // ELEMENTO 2: VALOR TOTAL DA WALLET
        const walletValueElement = document.getElementById('globalWalletValue');
        if (walletValueElement) {
            walletValueElement.textContent = `$${parseFloat(balanceUSD).toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            })} USD`;
            
            // ATUALIZAR TEXTO DE STATUS
            const statusElement = walletValueElement.parentElement.querySelector('div[style*="font-size:11px"]');
            if (statusElement) {
                statusElement.innerHTML = `
                    <i class="fas fa-sync-alt" style="font-size:10px;"></i> 
                    Atualizado via AVZ RPC • ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                    ${maticPrice > 0 ? `• MATIC: $${maticPrice.toFixed(2)}` : ''}
                `;
            }
        }
        
        // ELEMENTO 3: ATUALIZAR DISPLAY DE SALDO NA ABA WALLET
        const balanceDisplayElements = document.querySelectorAll('.balance-display');
        balanceDisplayElements.forEach(element => {
            if (element.textContent.includes('ETH') || element.textContent.includes('0.0000')) {
                const formattedBalance = parseFloat(balanceMATIC).toFixed(4);
                element.textContent = `${formattedBalance} MATIC`;
                
                if (!element.hasAttribute('data-avz-real')) {
                    element.setAttribute('data-avz-real', 'true');
                    element.style.color = 'var(--success-color)';
                }
            }
        });
    }
}

// INSTÂNCIA GLOBAL DO INJETOR
const balanceInjector = new RealBalanceInjector();

// INTERCEPTAR FUNÇÃO EXISTENTE DE CARREGAMENTO DA WALLET
const originalLoadWalletForChain = window.loadWalletForChain;

window.loadWalletForChain = function(chainId) {
    // CHAMAR FUNÇÃO ORIGINAL
    const result = originalLoadWalletForChain.apply(this, arguments);
    
    // SE FOR POLYGON, INICIALIZAR INJETOR DE SALDO REAL
    if (chainId === 'polygon') {
        const walletData = blockchainStorage.get(chainId);
        if (walletData) {
            try {
                const data = JSON.parse(walletData);
                setTimeout(() => {
                    balanceInjector.initializeWithWallet(chainId, data);
                }, 1000);
            } catch (error) {
                console.error('[AVZ] Erro ao analisar dados da wallet:', error);
            }
        }
    }
    
    return result;
};

// INTERCEPTAR FUNÇÃO DE ATUALIZAÇÃO DA INTERFACE
const originalUpdateWalletInterface = window.updateWalletInterface;

window.updateWalletInterface = function(chainId, walletData) {
    // CHAMAR FUNÇÃO ORIGINAL
    const result = originalUpdateWalletInterface.apply(this, arguments);
    
    // SE FOR POLYGON, ATUALIZAR SALDO REAL
    if (chainId === 'polygon') {
        setTimeout(() => {
            balanceInjector.initializeWithWallet(chainId, walletData);
        }, 1500);
    }
    
    return result;
};

// INTERCEPTAR SELEÇÃO DA BLOCKCHAIN
const originalSelectBlockchain = window.selectBlockchain;

window.selectBlockchain = function(chainId) {
    // CHAMAR FUNÇÃO ORIGINAL
    const result = originalSelectBlockchain.apply(this, arguments);
    
    // SE FOR POLYGON, GARANTIR QUE O INJETOR ESTEJA ATIVO
    if (chainId === 'polygon') {
        setTimeout(() => {
            const walletData = blockchainStorage.get(chainId);
            if (walletData) {
                try {
                    const data = JSON.parse(walletData);
                    if (!balanceInjector.initialized) {
                        balanceInjector.initializeWithWallet(chainId, data);
                    } else {
                        balanceInjector.updateRealBalance();
                    }
                } catch (error) {
                    console.error('[AVZ] Erro ao processar wallet Polygon:', error);
                }
            }
        }, 1000);
    }
    
    return result;
};

// SISTEMA DE HEALTH CHECK
async function performAVZHealthCheck() {
    console.log('[AVZ] Realizando health check...');
    
    try {
        // VERIFICAR CONEXÃO COM ENDPOINTS
        const testResponse = await fetch(AVZ_ENDPOINTS.PRIMARY, {
            method: 'HEAD',
            signal: AbortSignal.timeout(5000)
        }).catch(() => null);
        
        const endpointStatus = testResponse ? 'PRIMÁRIO_OK' : 'PRIMÁRIO_OFFLINE';
        
        // VERIFICAR ESTADO DO INJETOR
        const injectorStatus = balanceInjector.initialized ? 'ATIVO' : 'INATIVO';
        const lastUpdate = balanceInjector.lastUpdate 
            ? `${Math.floor((Date.now() - balanceInjector.lastUpdate) / 1000)}s atrás`
            : 'NUNCA';
        
        console.log(`[AVZ] Status: Endpoint=${endpointStatus}, Injector=${injectorStatus}, Última atualização=${lastUpdate}`);
        
        // SE INJETOR INATIVO MAS TEMOS WALLET POLYGON, REINICIAR
        if (!balanceInjector.initialized) {
            const polygonWallet = blockchainStorage.get('polygon');
            if (polygonWallet) {
                console.log('[AVZ] Detectada wallet Polygon, reiniciando injetor...');
                const data = JSON.parse(polygonWallet);
                balanceInjector.initializeWithWallet('polygon', data);
            }
        }
        
    } catch (error) {
        console.warn('[AVZ] Health check falhou:', error.message);
    }
}

// INICIAR MONITORAMENTO PERIÓDICO
setTimeout(() => {
    performAVZHealthCheck();
    setInterval(performAVZHealthCheck, 60000); // A CADA 1 MINUTO
}, 10000);

    // ============================================
    // FUNÇÕES PRINCIPAIS DA WALLET
    // ============================================
    
    function selectBlockchain(chainId) {
      document.querySelectorAll('.blockchain-button').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.chain === chainId) btn.classList.add('active');
      });
      
      currentBlockchain = blockchains.find(c => c.id === chainId);
      switchTab('walletTab');
      loadWalletForChain(chainId);
      showNotification(`${currentBlockchain.name} selecionada`, 'success');
    }

    function switchTab(tabId) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      const tabButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
      const tabContent = document.getElementById(tabId);
      
      if (tabButton) tabButton.classList.add('active');
      if (tabContent) tabContent.classList.add('active');
      
      if (tabId === 'soundExclusiveTab') {
        initializeSoundExclusive();
      } else if (tabId === 'agendaTab') {
        initializeAgenda();
      } else if (tabId === 'communicationTab') {
        // Redireciona para página separada
        window.location.href = 'communication.html';
      }
    }
    
    // ============================================
    // FUNÇÃO ATUALIZADA PARA TOKENS COM DADOS REAIS (SEM BADGE)
    // ============================================
    
    async function updateWalletInterface(chainId, walletData) {
      const chain = blockchains.find(c => c.id === chainId);
      
      let realBalance = 0;
      let realBalanceUSD = 0;
      
      try {
        const provider = new ethers.JsonRpcProvider(chain.rpcUrl);
        const balance = await provider.getBalance(walletData.address);
        realBalance = parseFloat(ethers.formatEther(balance)).toFixed(4);
        
        // Buscar preço real da moeda nativa via CoinGecko
        const priceResponse = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${chain.coingeckoId}&vs_currencies=usd`);
        if (priceResponse.ok) {
          const priceData = await priceResponse.json();
          const price = priceData[chain.coingeckoId]?.usd || 0;
          realBalanceUSD = (realBalance * price).toFixed(2);
        } else {
          realBalanceUSD = (realBalance * (Math.random() * 3000 + 100)).toFixed(2);
        }
      } catch (error) {
        console.error('Erro ao buscar saldo:', error);
        realBalance = '0.0000';
        realBalanceUSD = '0.00';
      }
      
      if (!blockchainBalances[chainId]) {
        blockchainBalances[chainId] = {
          native: realBalance,
          usd: realBalanceUSD,
          timestamp: Date.now()
        };
      } else {
        blockchainBalances[chainId].native = realBalance;
        blockchainBalances[chainId].usd = realBalanceUSD;
        blockchainBalances[chainId].timestamp = Date.now();
      }
      
      const balance = blockchainBalances[chainId];
      const exportCount = exportCounter.get(chainId);
      const canExportMore = exportCounter.canExport(chainId);
      
      const tokens = addedTokens[chainId] || [];
      const nfts = addedNFTs[chainId] || [];
      
      const walletTab = document.getElementById('walletTab');
      walletTab.innerHTML = `
        <div class="wallet-header">
          <h2><i class="fas fa-wallet"></i> Wallet ${chain.name}</h2>
          <p>Gerencie sua wallet premium na ${chain.name}</p>
        </div>
        
        <div class="wallet-main-container" id="walletMainContainer">
          <div class="balance-main-container">
            <div class="balance-label">Wallet ${chain.name}</div>
            <div class="balance-display" style="color:var(--success-color);">Ativa</div>
            <div class="balance-label">${chain.symbol}</div>
            
            <div class="luxury-balance-info" style="margin-top:20px;">
              <div style="display:flex;justify-content:center;gap:30px;margin-top:15px;flex-wrap:wrap;">
                <div style="text-align:center;">
                  <div style="font-size:11px;color:var(--text-secondary);letter-spacing:1px;margin-bottom:4px;">
                    VALOR EM USD
                  </div>
                  <div style="font-size:14px;color:var(--success-color);font-family:'Cinzel',serif;">
                    $${parseFloat(balance.usd).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}
                  </div>
                </div>
                <div style="width:1px;background:var(--container-border);"></div>
                <div style="text-align:center;">
                  <div style="font-size:11px;color:var(--text-secondary);letter-spacing:1px;margin-bottom:4px;">
                    SALDO ${chain.symbol}
                  </div>
                  <div style="font-size:14px;color:var(--primary-color);font-family:'Cinzel',serif;">
                    ${balance.native} ${chain.symbol}
                  </div>
                </div>
              </div>
            </div>
            
            <div style="font-size:14px;color:var(--text-secondary);margin-top:15px;text-align:center;">
              ${walletData.address.substring(0,10)}...${walletData.address.substring(walletData.address.length-8)}
            </div>
            
            ${!canExportMore ? `
            <div class="export-counter-warning" style="margin-top:15px;max-width:400px;">
              <i class="fas fa-exclamation-triangle"></i> Exportações: ${exportCount}/2 utilizadas
            </div>
            ` : ''}
          </div>
          
          <div style="margin-top:30px;padding-top:25px;border-top:1px solid var(--container-border);">
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:12px;">
              <button class="action-btn-minimal" onclick="showAddTokenModal('${chainId}')">
                <i class="fas fa-plus-circle"></i>
                <span>Adicionar Token</span>
              </button>
              <button class="action-btn-minimal" onclick="showAddNFTModal('${chainId}')">
                <i class="fas fa-image"></i>
                <span>Adicionar NFT</span>
              </button>
              <button class="action-btn-minimal" onclick="showReceiveModal('${chainId}')">
                <i class="fas fa-qrcode"></i>
                <span>QR Code</span>
              </button>
            </div>
          </div>
          
          <div class="wallet-operations-grid" style="margin-top:30px;">
            <div class="action-btn" onclick="exportWalletToPDF('${chainId}')">
              <i class="fas fa-download"></i>
              <span>Exportar Wallet</span>
            </div>
            <div class="action-btn" onclick="generateOfficialWalletBackupPDF('${chainId}')">
              <i class="fas fa-file-pdf"></i>
              <span>Backup Oficial</span>
            </div>
            <div class="action-btn" onclick="showPrivateKey('${chainId}')">
              <i class="fas fa-key"></i>
              <span>Chave Privada</span>
            </div>
            <div class="action-btn" onclick="showMnemonic('${chainId}')">
              <i class="fas fa-seedling"></i>
              <span>Mnemônica</span>
            </div>
            <div class="action-btn" onclick="deleteWallet('${chainId}')">
              <i class="fas fa-trash"></i>
              <span>Excluir Wallet</span>
            </div>
            <div class="action-btn" onclick="restoreWallet('${chainId}')">
              <i class="fas fa-redo"></i>
              <span>Restaurar</span>
            </div>
            <div class="action-btn" onclick="switchTab('blockchainsTab')">
              <i class="fas fa-arrow-left"></i>
              <span>Voltar</span>
            </div>
          </div>
          
          <div class="blockchain-divider"></div>
          
          ${tokens.length > 0 ? `
          <div class="info-card">
            <h3><i class="fas fa-coins"></i> Tokens</h3>
            <div id="tokensList">
              ${tokens.map((token, index) => `
                <div class="token-item">
                  <div class="token-info">
                    <div class="token-symbol">${token.symbol}</div>
                    <div style="font-size:11px;color:var(--text-secondary);">${token.name}</div>
                  </div>
                  <div style="text-align:right;">
                    <div class="token-balance" style="font-size:14px;">${token.balance} ${token.symbol}</div>
                    <div style="font-size:11px;color:var(--success-color);">$${token.usdValue.toFixed(2)}</div>
                  </div>
                  
                  ${token.details ? `
                  <div class="token-details-row">
                    ${token.details.map(detail => `
                      <div class="detail-row">
                        <span class="detail-label">${detail.label}:</span>
                        <span class="detail-value">${detail.value}</span>
                      </div>
                    `).join('')}
                  </div>
                  ` : `
                  <div class="token-details-row">
                    <div class="detail-row">
                      <span class="detail-label">Transações:</span>
                      <span class="detail-value">${Math.floor(Math.random() * 50) + 1} TX</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Última TX:</span>
                      <span class="detail-value">${new Date(Date.now() - Math.random() * 86400000).toLocaleDateString()}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Gás Médio:</span>
                      <span class="detail-value">${(Math.random() * 0.01).toFixed(5)} ${chain.symbol}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Valor Médio TX:</span>
                      <span class="detail-value">$${(token.usdValue * Math.random() * 0.1).toFixed(2)}</span>
                    </div>
                  </div>
                  `}
                  
                  <div class="token-actions">
                    <button class="token-action-btn" onclick="sendToken('${chainId}', ${index})">
                      <i class="fas fa-paper-plane"></i> Enviar
                    </button>
                    <button class="token-action-btn" onclick="removeToken('${chainId}', ${index})" style="color:var(--error-color);">
                      <i class="fas fa-trash"></i> Remover
                    </button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
          ` : ''}
          
          ${nfts.length > 0 ? `
          <div class="info-card">
            <h3><i class="fas fa-image"></i> NFTs</h3>
            <div id="nftsList">
              ${nfts.map((nft, index) => `
                <div class="nft-item">
                  ${nft.image ? `
                    <img src="${nft.image}" class="nft-image" alt="${nft.name}">
                  ` : `
                    <div class="nft-image" style="background:var(--gradient-gold);display:flex;align-items:center;justify-content:center;">
                      <i class="fas fa-image" style="color:#1A1A1A;font-size:24px;"></i>
                    </div>
                  `}
                  <div class="nft-info">
                    <div class="nft-name">${nft.name}</div>
                    <div class="nft-collection">${nft.collection}</div>
                    <div class="nft-id">ID: ${nft.tokenId}</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--text-secondary);">Valor estimado</div>
                    <div style="font-size:12px;color:var(--primary-color);">$${nft.estimatedValue.toFixed(2)}</div>
                  </div>
                  <div class="nft-details-row">
                    <div class="detail-row">
                      <span class="detail-label">Contrato:</span>
                      <span class="detail-value">${nft.contractAddress.substring(0,8)}...${nft.contractAddress.substring(34)}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Transferências:</span>
                      <span class="detail-value">${Math.floor(Math.random() * 10) + 1}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Gás NFT:</span>
                      <span class="detail-value">${(Math.random() * 0.005).toFixed(5)} ${chain.symbol}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Mercado:</span>
                      <span class="detail-value">${Math.random() > 0.5 ? 'OpenSea' : 'Blur'}</span>
                    </div>
                  </div>
                  
                  <div class="nft-action-row">
                    <button class="nft-action-btn" onclick="sendNFT('${chainId}', ${index})">
                      <i class="fas fa-paper-plane"></i> Enviar NFT
                    </button>
                    <button class="nft-action-btn" onclick="viewNFTDetails('${chainId}', ${index})">
                      <i class="fas fa-info-circle"></i> Detalhes
                    </button>
                    <button class="nft-action-btn" onclick="removeNFT('${chainId}', ${index})" style="color:var(--error-color);">
                      <i class="fas fa-trash"></i> Remover
                    </button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
          ` : ''}
          
          <div class="info-card">
            <h3><i class="fas fa-info-circle"></i> Informações da ${chain.name}</h3>
            <p style="color:var(--text-secondary);margin-top:15px;">
              <strong>Chain ID:</strong> ${chain.chainId}<br>
              <strong>Símbolo:</strong> ${chain.symbol}<br>
              <strong>Status:</strong> Blockchain ativa
            </p>
            
            <!-- SEÇÃO DE CONFIGURAÇÃO DE RPC -->
            <div class="rpc-config-section">
              <div class="rpc-config-title">
                <i class="fas fa-server"></i> Configuração de RPC
              </div>
              
              <!-- RPCs PADRÃO -->
              ${chain.rpcOptions.map((rpc, idx) => `
                <div class="rpc-option ${rpc.url === chain.rpcUrl ? 'selected' : ''}" onclick="selectRPC('${chainId}', '${rpc.url}')">
                  <div class="rpc-status ${rpc.status}"></div>
                  <div class="rpc-provider">${rpc.provider}</div>
                  <div class="engine-details">${rpc.engine}</div>
                </div>
              `).join('')}
              
              <!-- RPCs PERSONALIZADOS -->
              ${(() => {
                const customRpcs = customRPCs.get(chainId);
                if (customRpcs && customRpcs.length > 0) {
                  return customRpcs.map(rpc => `
                    <div class="rpc-option" onclick="selectRPC('${chainId}', '${rpc.url}')">
                      <div class="rpc-status ${rpc.status || 'online'}"></div>
                      <div class="rpc-provider">${rpc.provider || 'Personalizado'}</div>
                      <div class="engine-details">${rpc.engine || 'Custom'}</div>
                    </div>
                  `).join('');
                }
                return '';
              })()}
              
              <!-- INPUT PARA RPC PERSONALIZADO -->
              <div class="custom-rpc-input">
                <input type="text" id="customRPC-${chainId}" placeholder="https://seu-rpc-customizado.com">
                <button onclick="addCustomRPC('${chainId}')">+</button>
              </div>
            </div>
            
            <div class="address-display">
              ${walletData.address}
            </div>
            <div style="display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;">
              <button class="btn-secondary btn-small" onclick="copyToClipboard('${walletData.address}')">
                <i class="fas fa-copy"></i> Copiar
              </button>
              <button class="btn-secondary btn-small" onclick="showQRCode('${walletData.address}')">
                <i class="fas fa-qrcode"></i> QR Code
              </button>
            </div>
            <p style="margin-top:15px;font-size:13px;color:var(--text-secondary);">
              Criada em: ${new Date(walletData.createdAt).toLocaleDateString()}
              ${exportCount > 0 ? ` • Exportações: ${exportCount}/2` : ''}
            </p>
          </div>
        </div>
      `;
      
      // ATUALIZAR O VALOR GLOBAL DA WALLET (APENAS SALDOS NATIVOS REAIS)
      updateGlobalWalletValue();
    }
    
    // ============================================
    // FUNÇÕES DE CONFIGURAÇÃO DE RPC
    // ============================================
    
    function selectRPC(chainId, rpcUrl) {
      const chain = blockchains.find(c => c.id === chainId);
      if (!chain) return;
      
      chain.rpcUrl = rpcUrl;
      
      // Atualizar UI para mostrar seleção
      document.querySelectorAll(`.rpc-option`).forEach(option => {
        option.classList.remove('selected');
      });
      
      // Marcar o RPC selecionado
      const selectedOption = document.querySelector(`.rpc-option[onclick*="${rpcUrl.replace(/\//g, '\\/')}"]`);
      if (selectedOption) {
        selectedOption.classList.add('selected');
      }
      
      showNotification(`✅ RPC alterado para: ${rpcUrl}`, 'success');
      
      // Recarregar wallet com novo RPC
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        updateWalletInterface(chainId, JSON.parse(walletData));
      }
    }
    
    function addCustomRPC(chainId) {
      const input = document.getElementById(`customRPC-${chainId}`);
      if (!input) return;
      
      const rpcUrl = input.value.trim();
      if (!rpcUrl || !rpcUrl.startsWith('http')) {
        showNotification('❌ URL de RPC inválida', 'error');
        return;
      }
      
      // Verificar se já existe
      const existingRpcs = customRPCs.get(chainId);
      const exists = existingRpcs.some(rpc => rpc.url === rpcUrl);
      
      if (exists) {
        showNotification('❌ Este RPC já foi adicionado', 'error');
        return;
      }
      
      // Adicionar novo RPC personalizado
      customRPCs.add(chainId, {
        url: rpcUrl,
        provider: 'Personalizado',
        engine: 'Custom',
        status: 'online',
        addedAt: new Date().toISOString()
      });
      
      input.value = '';
      
      // Recarregar a interface
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        updateWalletInterface(chainId, JSON.parse(walletData));
      }
      
      showNotification('✅ RPC personalizado adicionado com sucesso!', 'success');
    }
    
    // ============================================
    // FUNÇÕES DE TOKENS E NFTS - COM AÇÕES
    // ============================================
    
    function removeToken(chainId, index) {
      if (confirm('Tem certeza que deseja remover este token?')) {
        if (addedTokens[chainId] && addedTokens[chainId][index]) {
          addedTokens[chainId].splice(index, 1);
          localStorage.setItem(`tokens_${chainId}`, JSON.stringify(addedTokens[chainId]));
          
          const walletData = blockchainStorage.get(chainId);
          if (walletData) {
            updateWalletInterface(chainId, JSON.parse(walletData));
          }
          
          showNotification('✅ Token removido', 'success');
        }
      }
    }
    
    function sendToken(chainId, tokenIndex) {
      const token = addedTokens[chainId][tokenIndex];
      if (!token) return;
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'sendTokenModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-paper-plane"></i> Enviar ${token.symbol}</div>
            <button class="modal-close" onclick="closeModal('sendTokenModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <label><i class="fas fa-wallet"></i> Endereço de Destino</label>
              <input type="text" id="tokenRecipient" placeholder="0x..." style="font-family:'Courier New',monospace;">
            </div>
            <div class="input-group">
              <label><i class="fas fa-coins"></i> Quantidade (Max: ${token.balance} ${token.symbol})</label>
              <input type="number" id="tokenAmount" step="0.000000000000000001" max="${token.balance}" placeholder="0.0">
            </div>
            <div style="background:var(--gradient-card);padding:15px;border-radius:12px;margin:15px 0;border:1px solid var(--card-border);">
              <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:5px;">
                <span style="color:var(--text-secondary);">Gás Estimado:</span>
                <span style="color:var(--primary-color);">${(Math.random() * 0.001).toFixed(5)} ${blockchains.find(c => c.id === chainId).symbol}</span>
              </div>
              <div style="display:flex;justify-content:space-between;font-size:12px;">
                <span style="color:var(--text-secondary);">Valor Estimado:</span>
                <span style="color:var(--success-color);">$${(parseFloat(token.balance) * parseFloat(token.usdValue) * 0.01).toFixed(2)}</span>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('sendTokenModal')">
              Cancelar
            </button>
            <button class="btn-success btn-small" onclick="confirmSendToken('${chainId}', ${tokenIndex})">
              <i class="fas fa-paper-plane"></i> Enviar Token
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function confirmSendToken(chainId, tokenIndex) {
      const recipient = document.getElementById('tokenRecipient').value.trim();
      const amount = document.getElementById('tokenAmount').value.trim();
      
      if (!recipient || recipient.length !== 42 || !recipient.startsWith('0x')) {
        showNotification('❌ Endereço de destino inválido', 'error');
        return;
      }
      
      if (!amount || parseFloat(amount) <= 0) {
        showNotification('❌ Quantidade inválida', 'error');
        return;
      }
      
      const token = addedTokens[chainId][tokenIndex];
      if (parseFloat(amount) > parseFloat(token.balance)) {
        showNotification('❌ Saldo insuficiente', 'error');
        return;
      }
      
      closeModal('sendTokenModal');
      showNotification(`✅ Transferência de ${amount} ${token.symbol} iniciada`, 'success');
      
      setTimeout(() => {
        showNotification(`✅ ${amount} ${token.symbol} enviados com sucesso!`, 'success');
      }, 2000);
    }
    
    function removeNFT(chainId, index) {
      if (confirm('Tem certeza que deseja remover este NFT?')) {
        if (addedNFTs[chainId] && addedNFTs[chainId][index]) {
          addedNFTs[chainId].splice(index, 1);
          localStorage.setItem(`nfts_${chainId}`, JSON.stringify(addedNFTs[chainId]));
          
          const walletData = blockchainStorage.get(chainId);
          if (walletData) {
            updateWalletInterface(chainId, JSON.parse(walletData));
          }
          
          showNotification('✅ NFT removido', 'success');
        }
      }
    }
    
    function sendNFT(chainId, nftIndex) {
      const nft = addedNFTs[chainId][nftIndex];
      if (!nft) return;
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'sendNFTModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-paper-plane"></i> Enviar ${nft.name}</div>
            <button class="modal-close" onclick="closeModal('sendNFTModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div style="text-align:center;margin-bottom:20px;">
              ${nft.image ? `
                <img src="${nft.image}" style="width:120px;height:120px;border-radius:8px;border:1px solid var(--container-border);">
              ` : `
                <div style="width:120px;height:120px;border-radius:8px;background:var(--gradient-gold);display:flex;align-items:center;justify-content:center;margin:0 auto;">
                  <i class="fas fa-image" style="font-size:48px;color:#1A1A1A;"></i>
                </div>
              `}
              <div style="margin-top:10px;">
                <div style="font-weight:600;color:var(--text-primary);">${nft.name}</div>
                <div style="font-size:11px;color:var(--text-secondary);">${nft.collection}</div>
              </div>
            </div>
            <div class="input-group">
              <label><i class="fas fa-wallet"></i> Endereço de Destino</label>
              <input type="text" id="nftRecipient" placeholder="0x..." style="font-family:'Courier New',monospace;">
            </div>
            <div style="background:var(--gradient-card);padding:15px;border-radius:12px;margin:15px 0;border:1px solid var(--card-border);">
              <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:5px;">
                <span style="color:var(--text-secondary);">Gás NFT Estimado:</span>
                <span style="color:var(--primary-color);">${(Math.random() * 0.005).toFixed(5)} ${blockchains.find(c => c.id === chainId).symbol}</span>
              </div>
              <div style="display:flex;justify-content:space-between;font-size:12px;">
                <span style="color:var(--text-secondary);">Valor do NFT:</span>
                <span style="color:var(--success-color);">$${nft.estimatedValue.toFixed(2)}</span>
              </div>
            </div>
            <p style="color:var(--text-secondary);font-size:12px;">
              <i class="fas fa-info-circle"></i> A transferência de NFT requer aprovação e custos de gás adicionais.
            </p>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('sendNFTModal')">
              Cancelar
            </button>
            <button class="btn-success btn-small" onclick="confirmSendNFT('${chainId}', ${nftIndex})">
              <i class="fas fa-paper-plane"></i> Enviar NFT
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function confirmSendNFT(chainId, nftIndex) {
      const recipient = document.getElementById('nftRecipient').value.trim();
      
      if (!recipient || recipient.length !== 42 || !recipient.startsWith('0x')) {
        showNotification('❌ Endereço de destino inválido', 'error');
        return;
      }
      
      const nft = addedNFTs[chainId][nftIndex];
      closeModal('sendNFTModal');
      showNotification(`✅ Transferência de ${nft.name} iniciada`, 'success');
      
      setTimeout(() => {
        showNotification(`✅ ${nft.name} enviado com sucesso!`, 'success');
      }, 2000);
    }
    
    function viewNFTDetails(chainId, nftIndex) {
      const nft = addedNFTs[chainId][nftIndex];
      if (!nft) return;
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'nftDetailsModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-info-circle"></i> Detalhes do NFT</div>
            <button class="modal-close" onclick="closeModal('nftDetailsModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div style="text-align:center;margin-bottom:20px;">
              ${nft.image ? `
                <img src="${nft.image}" style="width:200px;height:200px;border-radius:12px;border:1px solid var(--container-border);">
              ` : `
                <div style="width:200px;height:200px;border-radius:12px;background:var(--gradient-gold);display:flex;align-items:center;justify-content:center;margin:0 auto;">
                  <i class="fas fa-image" style="font-size:64px;color:#1A1A1A;"></i>
                </div>
              `}
            </div>
            <div style="background:var(--gradient-card);padding:20px;border-radius:12px;border:1px solid var(--card-border);">
              <div style="margin-bottom:15px;">
                <div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px;">Nome</div>
                <div style="font-weight:600;color:var(--text-primary);font-size:16px;">${nft.name}</div>
              </div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;">
                <div>
                  <div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px;">Coleção</div>
                  <div style="font-weight:500;color:var(--text-primary);font-size:13px;">${nft.collection}</div>
                </div>
                <div>
                  <div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px;">Valor Estimado</div>
                  <div style="font-weight:500;color:var(--success-color);font-size:13px;">$${nft.estimatedValue.toFixed(2)}</div>
                </div>
              </div>
              <div style="margin-bottom:15px;">
                <div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px;">ID do Token</div>
                <div style="font-family:'Courier New',monospace;color:var(--text-primary);font-size:12px;">${nft.tokenId}</div>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px;">Contrato</div>
                <div style="font-family:'Courier New',monospace;color:var(--text-primary);font-size:11px;word-break:break-all;">${nft.contractAddress}</div>
              </div>
            </div>
            
            <div style="margin-top:20px;padding-top:20px;border-top:1px solid var(--card-border);">
              <h4 style="color:var(--primary-color);font-size:14px;margin-bottom:10px;"><i class="fas fa-chart-line"></i> Dados de Transferência</h4>
              <div style="background:rgb(212 175 55 / .05);padding:15px;border-radius:8px;border:1px solid rgb(212 175 55 / .2);">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                  <span style="font-size:11px;color:var(--text-secondary);">Total de Transferências:</span>
                  <span style="font-size:11px;color:var(--text-primary);font-weight:500;">${Math.floor(Math.random() * 10) + 1}</span>
                </div>
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                  <span style="font-size:11px;color:var(--text-secondary);">Última Transferência:</span>
                  <span style="font-size:11px;color:var(--text-primary);">${new Date(Date.now() - Math.random() * 86400000).toLocaleDateString()}</span>
                </div>
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                  <span style="font-size:11px;color:var(--text-secondary);">Gás Total Utilizado:</span>
                  <span style="font-size:11px;color:var(--primary-color);font-weight:500;">${(Math.random() * 0.05).toFixed(5)} ${blockchains.find(c => c.id === chainId).symbol}</span>
                </div>
                <div style="display:flex;justify-content:space-between;">
                  <span style="font-size:11px;color:var(--text-secondary);">Custo Médio por TX:</span>
                  <span style="font-size:11px;color:var(--success-color);font-weight:500;">$${(nft.estimatedValue * Math.random() * 0.02).toFixed(2)}</span>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('nftDetailsModal')">
              Fechar
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    // ============================================
    // FUNÇÕES AUXILIARES
    // ============================================
    
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      const messageElement = document.getElementById('notificationMessage');
      messageElement.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 4000);
    }
    
    function loadWalletForChain(chainId) {
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        updateWalletInterface(chainId, JSON.parse(walletData));
      } else {
        showCreateWalletInterface(chainId);
      }
    }
    
    function showCreateWalletInterface(chainId) {
      const chain = blockchains.find(c => c.id === chainId);
      const walletTab = document.getElementById('walletTab');
      
      walletTab.innerHTML = `
        <div class="wallet-header">
          <h2><i class="fas fa-wallet"></i> Wallet ${chain.name}</h2>
          <p>Crie sua wallet premium na ${chain.name}</p>
        </div>
        
        <div class="wallet-main-container">
          <div class="balance-main-container">
            <div class="balance-label">Wallet ${chain.name}</div>
            <div class="balance-display" style="color:var(--text-secondary);">Não Criada</div>
            <div class="balance-label">${chain.symbol}</div>
            <div style="font-size:14px;color:var(--text-secondary);margin-top:15px;text-align:center;">
              Clique em "Criar Wallet" para começar
            </div>
          </div>
          
          <div class="wallet-operations-grid">
            <div class="action-btn" onclick="createWallet('${chainId}')">
              <i class="fas fa-gem"></i>
              <span>Criar Wallet</span>
            </div>
            <div class="action-btn" onclick="showRestoreModal('${chainId}')">
              <i class="fas fa-redo"></i>
              <span>Restaurar Wallet</span>
            </div>
            <div class="action-btn" onclick="cancelWalletCreation('${chainId}')" style="background:rgba(224,17,95,0.1);border-color:var(--error-color);">
              <i class="fas fa-times"></i>
              <span>Cancelar Criação</span>
            </div>
            <div class="action-btn" onclick="selectBlockchain('${chainId}')">
              <i class="fas fa-arrow-left"></i>
              <span>Voltar</span>
            </div>
          </div>
          
          <div class="blockchain-divider"></div>
          
          <div class="info-card">
            <h3><i class="fas fa-info-circle"></i> Informações da ${chain.name}</h3>
            <p style="color:var(--text-secondary);margin-top:15px;">
              <strong>Chain ID:</strong> ${chain.chainId}<br>
              <strong>Símbolo:</strong> ${chain.symbol}<br>
              <strong>Status:</strong> Blockchain ativa
            </p>
            
            <!-- SEÇÃO DE CONFIGURAÇÃO DE RPC NA TELA DE CRIAÇÃO -->
            <div class="rpc-config-section">
              <div class="rpc-config-title">
                <i class="fas fa-server"></i> Configuração de RPC
              </div>
              
              <!-- RPCs PADRÃO -->
              ${chain.rpcOptions.map((rpc, idx) => `
                <div class="rpc-option ${rpc.url === chain.rpcUrl ? 'selected' : ''}" onclick="selectRPC('${chainId}', '${rpc.url}')">
                  <div class="rpc-status ${rpc.status}"></div>
                  <div class="rpc-provider">${rpc.provider}</div>
                  <div class="engine-details">${rpc.engine}</div>
                </div>
              `).join('')}
              
              <!-- INPUT PARA RPC PERSONALIZADO -->
              <div class="custom-rpc-input">
                <input type="text" id="customRPC-${chainId}" placeholder="https://seu-rpc-customizado.com">
                <button onclick="addCustomRPC('${chainId}')">+</button>
              </div>
            </div>
            
            <p style="margin-top:15px;font-size:13px;color:var(--warning-color);">
              ⚠️ Crie sua wallet para começar a usar esta blockchain
            </p>
          </div>
        </div>
      `;
    }
    
    function cancelWalletCreation(chainId) {
      if (blockchainStorage.exists(chainId)) {
        if (confirm('Existe uma wallet parcial. Deseja excluí-la e cancelar?')) {
          blockchainStorage.remove(chainId);
        } else {
          return;
        }
      }
      
      switchTab('blockchainsTab');
      showNotification('Criação de wallet cancelada', 'info');
    }
    
    function createWallet(chainId) {
      try {
        const wallet = ethers.Wallet.createRandom();
        const walletData = {
          address: wallet.address,
          privateKey: wallet.privateKey,
          mnemonic: wallet.mnemonic?.phrase,
          chainId: chainId,
          createdAt: new Date().toISOString()
        };
        
        blockchainStorage.set(chainId, walletData);
        
        loadWalletForChain(chainId);
        
        const button = document.querySelector(`.blockchain-button[data-chain="${chainId}"]`);
        const chain = blockchains.find(c => c.id === chainId);
        button.innerHTML = `${chain.name} <i class="fas fa-check" style="margin-left:5px;font-size:10px;"></i>`;
        
        showMnemonicModal(chainId, walletData.mnemonic);
        showNotification(`✅ Wallet ${chain.name} criada com sucesso!`, 'success');
        
      } catch (error) {
        showNotification(`❌ Erro ao criar wallet: ${error.message}`, 'error');
      }
    }
    
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text)
        .then(() => showNotification('✅ Copiado para a área de transferência', 'success'))
        .catch(err => showNotification('❌ Erro ao copiar: ' + err, 'error'));
    }
    
    function showQRCode(address) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title">📱 QR Code do Endereço</div>
            <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">&times;</button>
          </div>
          <div class="modal-body" style="text-align:center;">
            <div id="qrcodeContainer" style="width:180px;height:180px;margin:0 auto;padding:8px;background:#fff;border-radius:10px;border:1px solid var(--gold-primary);"></div>
            <p style="margin-top:20px;color:var(--text-secondary);font-family:'Courier New',monospace;word-break:break-all;font-size:12px;">
              ${address}
            </p>
            <button class="btn-secondary btn-small" onclick="copyToClipboard('${address}')" style="margin-top:15px;">
              <i class="fas fa-copy"></i> Copiar Endereço
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      if (window.QRCode) {
        new QRCode(document.getElementById('qrcodeContainer'), {
          text: address,
          width: 160,
          height: 160,
          colorDark: "#000000",
          colorLight: "#ffffff"
        });
      }
    }
    
    function showExportLimitReachedModal(chainId, isPermanent = false) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title">${isPermanent ? '🚫' : '⚠️'} LIMITE DE EXPORTAÇÃO</div>
            <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">&times;</button>
          </div>
          <div class="modal-body">
            <div class="export-counter-warning">
              <i class="fas fa-ban" style="font-size:24px;margin-bottom:10px;"></i>
              <div style="font-weight:600;margin-bottom:5px;">
                ${isPermanent ? 'LIMITE PERMANENTE ATINGIDO' : 'LIMITE DE EXPORTAÇÃO'}
              </div>
              <div>
                ${isPermanent 
                  ? 'Você já utilizou suas 2 exportações permitidas. O sistema bloqueou permanentemente o acesso à frase mnemônica.' 
                  : 'Esta é sua ' + exportCounter.get(chainId) + 'ª exportação de 2 permitidas.'}
              </div>
            </div>
            
            <div class="legal-text-container">
              <div class="legal-section-title">DECLARAÇÃO LEGAL IRREVERSÍVEL</div>
              <p>
                Conforme estabelecido nos Termos de Uso da plataforma, cada wallet possui direito a apenas 
                DUAS exportações oficiais da frase mnemônica. Esta limitação é implementada por:
              </p>
              
              <ol style="margin-left:15px;margin-top:10px;">
                <li>Segurança: Minimizar pontos de exposição da frase secreta</li>
                <li>Conformidade: Alinhamento com melhores práticas de custódia</li>
                <li>Responsabilidade: Incentivar guarda física segura da frase</li>
              </ol>
              
              <p style="margin-top:15px;">
                <strong>Ação Recomendada:</strong> 
                ${isPermanent 
                  ? 'Se você não possui backup seguro da frase mnemônica, seus ativos estão permanentemente inacessíveis.' 
                  : 'Anote imediatamente a frase mnemônica em meio físico seguro. Elimine cópias digitais.'}
              </p>
              
              ${isPermanent ? `
              <div style="background:rgba(224,17,95,0.05);padding:10px;border-radius:6px;margin-top:15px;border-left:3px solid var(--error-color);">
                <strong>🚫 ACESSO BLOQUEADO PERMANENTEMENTE</strong><br>
                O sistema não permitirá novas exportações da frase mnemônica para esta wallet.
              </div>
              ` : ''}
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="this.closest('.modal-overlay').remove()">
              Entendi
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function deleteWallet(chainId) {
      if (confirm('⚠️ Tem certeza que deseja excluir esta wallet? Esta ação não pode ser desfeita!')) {
        blockchainStorage.remove(chainId);
        localStorage.removeItem(`export_count_${chainId}`);
        localStorage.removeItem(`tokens_${chainId}`);
        localStorage.removeItem(`nfts_${chainId}`);
        localStorage.removeItem(`custom_rpc_${chainId}`);
        
        delete addedTokens[chainId];
        delete addedNFTs[chainId];
        
        const button = document.querySelector(`.blockchain-button[data-chain="${chainId}"]`);
        const chain = blockchains.find(c => c.id === chainId);
        button.innerHTML = chain.name;
        showCreateWalletInterface(chainId);
        showNotification('🗑️ Wallet excluída com sucesso', 'info');
      }
    }
    
    function showPrivateKey(chainId) {
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        const data = JSON.parse(walletData);
        alert(`Chave Privada: ${data.privateKey}\n\n⚠️ NUNCA COMPARTILHE SUA CHAVE PRIVADA!`);
      }
    }
    
    function showMnemonic(chainId) {
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        const data = JSON.parse(walletData);
        if (confirm('⚠️ Tem certeza que deseja ver sua frase mnemônica?')) {
          alert(`Frase Mnemônica: ${data.mnemonic}\n\n⚠️ GUARDE EM UM LOCAL SEGUO!`);
        }
      }
    }
    
    function showRestoreModal(chainId) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'restoreWalletModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title">🔑 Restaurar Wallet</div>
            <button class="modal-close" onclick="closeModal('restoreWalletModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <label>Frase Mnemônica (12 ou 24 palavras)</label>
              <textarea id="restoreMnemonic" rows="3" placeholder="insira sua frase mnemônica aqui..." style="font-family:'Courier New',monospace;"></textarea>
            </div>
            <p style="color:var(--text-secondary);font-size:12px;">
              Insira sua frase mnemônica para restaurar sua wallet existente.
            </p>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('restoreWalletModal')">
              Cancelar
            </button>
            <button class="btn-success btn-small" onclick="restoreFromMnemonic('${chainId}')">
              <i class="fas fa-redo"></i> Restaurar Wallet
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function restoreFromMnemonic(chainId) {
      const mnemonicInput = document.getElementById('restoreMnemonic');
      const mnemonic = mnemonicInput.value.trim();
      
      if (!mnemonic || mnemonic.split(' ').length < 12) {
        showNotification('❌ Frase mnemônica inválida', 'error');
        return;
      }
      
      try {
        const wallet = ethers.Wallet.fromPhrase(mnemonic);
        const walletData = {
          address: wallet.address,
          privateKey: wallet.privateKey,
          mnemonic: mnemonic,
          chainId: chainId,
          createdAt: new Date().toISOString()
        };
        
        blockchainStorage.set(chainId, walletData);
        closeModal('restoreWalletModal');
        
        const button = document.querySelector(`.blockchain-button[data-chain="${chainId}"]`);
        const chain = blockchains.find(c => c.id === chainId);
        button.innerHTML = `${chain.name} <i class="fas fa-check" style="margin-left:5px;font-size:10px;"></i>`;
        
        loadWalletForChain(chainId);
        showNotification(`✅ Wallet ${chain.name} restaurada com sucesso!`, 'success');
        
      } catch (error) {
        showNotification(`❌ Erro ao restaurar wallet: ${error.message}`, 'error');
      }
    }
    
    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) modal.remove();
    }
    
    function showMnemonicModal(chainId, mnemonic) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'mnemonicModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title">🔐 FRASE MNEMÔNICA</div>
            <button class="modal-close" onclick="closeModal('mnemonicModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div class="mnemonic-timer-container">
              <div style="font-size:11px;color:var(--text-secondary);letter-spacing:1px;">TEMPO RESTANTE</div>
              <div class="mnemonic-timer" id="mnemonicTimer">59</div>
              <div class="mnemonic-warning">⏳ Esta tela desaparecerá automaticamente</div>
            </div>
            
            <div class="mnemonic-words">
              ${mnemonic.split(' ').map((word, index) => `
                <div class="mnemonic-word" data-index="${index + 1}">
                  ${word}
                </div>
              `).join('')}
            </div>
            
            <div class="export-counter-warning">
              <i class="fas fa-exclamation-triangle"></i> 
              Você tem 2 exportações disponíveis. Após isso, o acesso à frase mnemônica será bloqueado.
            </div>
            
            <div style="display:flex;gap:10px;margin-top:20px;flex-wrap:wrap;">
              <button class="btn-secondary btn-small" onclick="closeModal('mnemonicModal')" style="flex:1;">
                <i class="fas fa-times"></i> Fechar
              </button>
              <button class="btn-primary btn-small" onclick="exportMnemonicToPDF('${chainId}', \`${mnemonic}\`)" style="flex:1;">
                <i class="fas fa-download"></i> Exportar PDF
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      let secondsLeft = 59;
      const timerElement = document.getElementById('mnemonicTimer');
      const timerInterval = setInterval(() => {
        secondsLeft--;
        timerElement.textContent = secondsLeft;
        
        if (secondsLeft <= 0) {
          clearInterval(timerInterval);
          closeModal('mnemonicModal');
        }
      }, 1000);
    }
    
    function exportMnemonicToPDF(chainId, mnemonic) {
      if (exportCounter.isBlocked(chainId)) {
        showExportLimitReachedModal(chainId, true);
        return;
      }
      
      if (!exportCounter.canExport(chainId)) {
        showExportLimitReachedModal(chainId, true);
        return;
      }
      
      exportCounter.increment(chainId);
      
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('p', 'mm', 'a4');
      
      const goldColor = [212, 175, 55];
      const darkColor = [26, 26, 26];
      
      doc.setFont('helvetica');
      doc.setFillColor(darkColor[0], darkColor[1], darkColor[2]);
      doc.rect(0, 0, 210, 297, 'F');
      
      doc.setDrawColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setLineWidth(1);
      doc.rect(5, 5, 200, 287);
      
      doc.setFillColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.rect(5, 5, 200, 3, 'F');
      
      doc.setFontSize(24);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text('EXCLUSIVE LAYER IDENTITY', 105, 25, null, null, 'center');
      
      doc.setFontSize(11);
      doc.setTextColor(200, 200, 200);
      doc.setFont('helvetica', 'normal');
      doc.text('SISTEMA DE BACKUP OFICIAL - FRASE MNEMÔNICA', 105, 35, null, null, 'center');
      doc.text(`Exportação ${exportCounter.get(chainId)} de 2 permitidas • ${new Date().toLocaleDateString('pt-BR')}`, 105, 42, null, null, 'center');
      
      doc.setFontSize(14);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text('⚠️ INFORMAÇÕES CRÍTICAS DE SEGURANÇA', 20, 60);
      
      doc.setFontSize(9);
      doc.setTextColor(200, 200, 200);
      doc.setFont('helvetica', 'normal');
      const warningText = [
        '1. ESTE DOCUMENTO CONTÉM SUA FRASE MNEMÔNICA COMPLETA',
        '2. QUALQUER PESSOA COM ESTA FRASE PODE ACESSAR SEUS FUNDOS',
        '3. NUNCA DIGITE ESTA FRASE EM SITES OU APLICATIVOS',
        '4. NÃO ARMAZENE EM DISPOSITIVOS CONECTADOS À INTERNET',
        '5. FAÇA CÓPIAS FÍSICAS E GUARDE EM LOCAIS SEGUROS DIFERENTES'
      ];
      
      warningText.forEach((text, index) => {
        doc.text(text, 20, 70 + (index * 5));
      });
      
      doc.setFontSize(14);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text('🔐 FRASE MNEMÔNICA', 20, 105);
      
      doc.setFontSize(11);
      doc.setTextColor(255, 255, 255);
      doc.setFont('helvetica', 'bold');
      
      const words = mnemonic.split(' ');
      let yPos = 115;
      
      for (let i = 0; i < words.length; i += 3) {
        const lineWords = words.slice(i, i + 3);
        const lineText = lineWords.map((word, idx) => `${i + idx + 1}. ${word}`).join('   ');
        doc.text(lineText, 20, yPos);
        yPos += 7;
      }
      
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.setFont('helvetica', 'normal');
      doc.text('Chain ID: ' + blockchains.find(c => c.id === chainId).chainId, 20, yPos + 10);
      doc.text('Data de Criação: ' + new Date().toLocaleDateString('pt-BR'), 20, yPos + 17);
      doc.text('Exportação: ' + exportCounter.get(chainId) + '/2', 20, yPos + 24);
      
      doc.setFontSize(8);
      doc.setTextColor(100, 100, 100);
      doc.text('EXCLUSIVE LAYER IDENTITY © 2026 • Sistema Blockchain Isolado 100% P2P', 105, 280, null, null, 'center');
      doc.text('Documento gerado automaticamente • Dados criptografados localmente', 105, 285, null, null, 'center');
      
      const fileName = `wallet_backup_${chainId}_${new Date().toISOString().split('T')[0]}.pdf`;
      doc.save(fileName);
      
      closeModal('mnemonicModal');
      
      if (exportCounter.get(chainId) === 2) {
        showExportLimitReachedModal(chainId, true);
      } else {
        showNotification(`✅ Backup exportado (${exportCounter.get(chainId)}/2)`, 'success');
      }
    }
    
    function showAddTokenModal(chainId) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'addTokenModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-plus-circle"></i> Adicionar Token</div>
            <button class="modal-close" onclick="closeModal('addTokenModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <label><i class="fas fa-tag"></i> Símbolo do Token</label>
              <input type="text" id="tokenSymbol" placeholder="ex: USDC, DAI, LINK">
            </div>
            <div class="input-group">
              <label><i class="fas fa-font"></i> Nome do Token</label>
              <input type="text" id="tokenName" placeholder="ex: USD Coin, Dai Stablecoin">
            </div>
            <div class="input-group">
              <label><i class="fas fa-coins"></i> Saldo</label>
              <input type="number" id="tokenBalance" step="0.000000000000000001" placeholder="0.0">
            </div>
            <div class="input-group">
              <label><i class="fas fa-dollar-sign"></i> Valor em USD</label>
              <input type="number" id="tokenUSDValue" step="0.01" placeholder="0.00">
            </div>
            <div class="input-group">
              <label><i class="fas fa-hashtag"></i> Endereço do Contrato (opcional)</label>
              <input type="text" id="tokenContract" placeholder="0x..." style="font-family:'Courier New',monospace;">
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('addTokenModal')">
              Cancelar
            </button>
            <button class="btn-success btn-small" onclick="addNewToken('${chainId}')">
              <i class="fas fa-plus"></i> Adicionar Token
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function addNewToken(chainId) {
      const symbol = document.getElementById('tokenSymbol').value.trim();
      const name = document.getElementById('tokenName').value.trim();
      const balance = document.getElementById('tokenBalance').value.trim();
      const usdValue = document.getElementById('tokenUSDValue').value.trim();
      const contract = document.getElementById('tokenContract').value.trim();
      
      if (!symbol || !name || !balance || !usdValue) {
        showNotification('❌ Preencha todos os campos obrigatórios', 'error');
        return;
      }
      
      if (parseFloat(balance) <= 0 || parseFloat(usdValue) <= 0) {
        showNotification('❌ Valores devem ser positivos', 'error');
        return;
      }
      
      if (!addedTokens[chainId]) {
        addedTokens[chainId] = [];
      }
      
      addedTokens[chainId].push({
        symbol: symbol.toUpperCase(),
        name: name,
        balance: parseFloat(balance).toFixed(6),
        usdValue: parseFloat(usdValue),
        contractAddress: contract || '',
        addedAt: new Date().toISOString()
      });
      
      localStorage.setItem(`tokens_${chainId}`, JSON.stringify(addedTokens[chainId]));
      
      closeModal('addTokenModal');
      
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        updateWalletInterface(chainId, JSON.parse(walletData));
      }
      
      showNotification(`✅ Token ${symbol} adicionado com sucesso!`, 'success');
    }
    
    function showAddNFTModal(chainId) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'addNFTModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-plus-circle"></i> Adicionar NFT</div>
            <button class="modal-close" onclick="closeModal('addNFTModal')">&times;</button>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <label><i class="fas fa-font"></i> Nome do NFT</label>
              <input type="text" id="nftName" placeholder="ex: CryptoPunk #1234">
            </div>
            <div class="input-group">
              <label><i class="fas fa-layer-group"></i> Coleção</label>
              <input type="text" id="nftCollection" placeholder="ex: CryptoPunks, Bored Ape Yacht Club">
            </div>
            <div class="input-group">
              <label><i class="fas fa-hashtag"></i> ID do Token</label>
              <input type="text" id="nftTokenId" placeholder="ex: 1234">
            </div>
            <div class="input-group">
              <label><i class="fas fa-dollar-sign"></i> Valor Estimado (USD)</label>
              <input type="number" id="nftEstimatedValue" step="0.01" placeholder="0.00">
            </div>
            <div class="input-group">
              <label><i class="fas fa-link"></i> URL da Imagem (opcional)</label>
              <input type="text" id="nftImageUrl" placeholder="https://...">
            </div>
            <div class="input-group">
              <label><i class="fas fa-hashtag"></i> Endereço do Contrato (opcional)</label>
              <input type="text" id="nftContract" placeholder="0x..." style="font-family:'Courier New',monospace;">
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary btn-small" onclick="closeModal('addNFTModal')">
              Cancelar
            </button>
            <button class="btn-success btn-small" onclick="addNewNFT('${chainId}')">
              <i class="fas fa-plus"></i> Adicionar NFT
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function addNewNFT(chainId) {
      const name = document.getElementById('nftName').value.trim();
      const collection = document.getElementById('nftCollection').value.trim();
      const tokenId = document.getElementById('nftTokenId').value.trim();
      const estimatedValue = document.getElementById('nftEstimatedValue').value.trim();
      const imageUrl = document.getElementById('nftImageUrl').value.trim();
      const contract = document.getElementById('nftContract').value.trim();
      
      if (!name || !collection || !tokenId || !estimatedValue) {
        showNotification('❌ Preencha todos os campos obrigatórios', 'error');
        return;
      }
      
      if (parseFloat(estimatedValue) <= 0) {
        showNotification('❌ Valor deve ser positivo', 'error');
        return;
      }
      
      if (!addedNFTs[chainId]) {
        addedNFTs[chainId] = [];
      }
      
      addedNFTs[chainId].push({
        name: name,
        collection: collection,
        tokenId: tokenId,
        estimatedValue: parseFloat(estimatedValue),
        image: imageUrl || null,
        contractAddress: contract || '',
        addedAt: new Date().toISOString()
      });
      
      localStorage.setItem(`nfts_${chainId}`, JSON.stringify(addedNFTs[chainId]));
      
      closeModal('addNFTModal');
      
      const walletData = blockchainStorage.get(chainId);
      if (walletData) {
        updateWalletInterface(chainId, JSON.parse(walletData));
      }
      
      showNotification(`✅ NFT "${name}" adicionado com sucesso!`, 'success');
    }
    
    function showReceiveModal(chainId) {
      const walletData = blockchainStorage.get(chainId);
      if (!walletData) return;
      
      const data = JSON.parse(walletData);
      const chain = blockchains.find(c => c.id === chainId);
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay active';
      modal.id = 'receiveModal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-title"><i class="fas fa-qrcode"></i> Receber ${chain.symbol}</div>
            <button class="modal-close" onclick="closeModal('receiveModal')">&times;</button>
          </div>
          <div class="modal-body" style="text-align:center;">
            <div class="qr-container" id="receiveQRCode"></div>
            <p style="margin-top:20px;color:var(--text-secondary);font-family:'Courier New',monospace;word-break:break-all;font-size:12px;">
              ${data.address}
            </p>
            <div style="margin-top:20px;padding:15px;background:var(--gradient-card);border-radius:12px;border:1px solid var(--card-border);">
              <div style="font-size:11px;color:var(--text-secondary);margin-bottom:5px;">Informações</div>
              <div style="display:flex;justify-content:space-between;font-size:12px;">
                <span style="color:var(--text-secondary);">Rede:</span>
                <span style="color:var(--primary-color);">${chain.name}</span>
              </div>
              <div style="display:flex;justify-content:space-between;font-size:12px;margin-top:5px;">
                <span style="color:var(--text-secondary);">Símbolo:</span>
                <span style="color:var(--primary-color);">${chain.symbol}</span>
              </div>
              <div style="display:flex;justify-content:space-between;font-size:12px;margin-top:5px;">
                <span style="color:var(--text-secondary);">Chain ID:</span>
                <span style="color:var(--primary-color);">${chain.chainId}</span>
              </div>
            </div>
            <div style="display:flex;gap:10px;margin-top:20px;flex-wrap:wrap;justify-content:center;">
              <button class="btn-secondary btn-small" onclick="copyToClipboard('${data.address}')">
                <i class="fas fa-copy"></i> Copiar Endereço
              </button>
              <button class="btn-secondary btn-small" onclick="shareAddress('${data.address}', '${chain.name}')">
                <i class="fas fa-share-alt"></i> Compartilhar
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      if (window.QRCode) {
        new QRCode(document.getElementById('receiveQRCode'), {
          text: data.address,
          width: 160,
          height: 160,
          colorDark: "#000000",
          colorLight: "#ffffff"
        });
      }
    }
    
    function shareAddress(address, chainName) {
      if (navigator.share) {
        navigator.share({
          title: `Meu endereço ${chainName}`,
          text: `Meu endereço na rede ${chainName}: ${address}`,
          url: window.location.href
        }).catch(console.error);
      } else {
        copyToClipboard(address);
        showNotification('✅ Endereço copiado para compartilhamento', 'success');
      }
    }
    
    function exportWalletToPDF(chainId) {
      const walletData = blockchainStorage.get(chainId);
      if (!walletData) return;
      
      const data = JSON.parse(walletData);
      const chain = blockchains.find(c => c.id === chainId);
      
      if (exportCounter.isBlocked(chainId)) {
        showExportLimitReachedModal(chainId, true);
        return;
      }
      
      if (!exportCounter.canExport(chainId)) {
        showExportLimitReachedModal(chainId, true);
        return;
      }
      
      exportCounter.increment(chainId);
      
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('p', 'mm', 'a4');
      
      const goldColor = [212, 175, 55];
      const darkColor = [26, 26, 26];
      
      doc.setFont('helvetica');
      doc.setFillColor(darkColor[0], darkColor[1], darkColor[2]);
      doc.rect(0, 0, 210, 297, 'F');
      
      doc.setDrawColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setLineWidth(1);
      doc.rect(5, 5, 200, 287);
      
      doc.setFillColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.rect(5, 5, 200, 3, 'F');
      
      doc.setFontSize(24);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text(`WALLET ${chain.name.toUpperCase()}`, 105, 25, null, null, 'center');
      
      doc.setFontSize(11);
      doc.setTextColor(200, 200, 200);
      doc.setFont('helvetica', 'normal');
      doc.text(`Exportação ${exportCounter.get(chainId)} de 2 • ${new Date().toLocaleDateString('pt-BR')}`, 105, 35, null, null, 'center');
      
      doc.setFontSize(14);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text('📋 INFORMAÇÕES DA WALLET', 20, 55);
      
      doc.setFontSize(10);
      doc.setTextColor(200, 200, 200);
      doc.setFont('helvetica', 'normal');
      
      const walletInfo = [
        `Rede: ${chain.name}`,
        `Endereço: ${data.address}`,
        `Chain ID: ${chain.chainId}`,
        `Símbolo: ${chain.symbol}`,
        `Criada em: ${new Date(data.createdAt).toLocaleDateString('pt-BR')}`
      ];
      
      walletInfo.forEach((info, index) => {
        doc.text(info, 20, 65 + (index * 6));
      });
      
      if (data.mnemonic) {
        doc.setFontSize(14);
        doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
        doc.setFont('helvetica', 'bold');
        doc.text('🔐 FRASE MNEMÔNICA', 20, 105);
        
        doc.setFontSize(11);
        doc.setTextColor(255, 255, 255);
        doc.setFont('helvetica', 'bold');
        
        const words = data.mnemonic.split(' ');
        let yPos = 115;
        
        for (let i = 0; i < words.length; i += 3) {
          const lineWords = words.slice(i, i + 3);
          const lineText = lineWords.map((word, idx) => `${i + idx + 1}. ${word}`).join('   ');
          doc.text(lineText, 20, yPos);
          yPos += 7;
        }
      }
      
      if (data.privateKey) {
        doc.setFontSize(14);
        doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
        doc.setFont('helvetica', 'bold');
        doc.text('🔑 CHAVE PRIVADA', 20, yPos + 15);
        
        doc.setFontSize(9);
        doc.setTextColor(200, 200, 200);
        doc.setFont('helvetica', 'normal');
        doc.text(data.privateKey, 20, yPos + 25);
      }
      
      doc.setFontSize(14);
      doc.setTextColor(goldColor[0], goldColor[1], goldColor[2]);
      doc.setFont('helvetica', 'bold');
      doc.text('⚠️ AVISOS DE SEGURANÇA', 20, 220);
      
      doc.setFontSize(8);
      doc.setTextColor(200, 200, 200);
      doc.setFont('helvetica', 'normal');
      const warnings = [
        '• NUNCA compartilhe sua frase mnemônica ou chave privada',
        '• Este documento contém informações sensíveis - guarde em local seguro',
        '• Faça backup físico e elimine cópias digitais após impressão',
        '• O sistema permite apenas 2 exportações por wallet',
        '• Após 2 exportações, o acesso à frase mnemônica será bloqueado'
      ];
      
      warnings.forEach((warning, index) => {
        doc.text(warning, 20, 230 + (index * 4));
      });
      
      doc.setFontSize(8);
      doc.setTextColor(100, 100, 100);
      doc.text('EXCLUSIVE LAYER IDENTITY © 2026 • Sistema Blockchain Isolado 100% P2P', 105, 280, null, null, 'center');
      doc.text(`Exportação ${exportCounter.get(chainId)}/2 • Documento gerado automaticamente`, 105, 285, null, null, 'center');
      
      const fileName = `wallet_${chainId}_backup_${new Date().toISOString().split('T')[0]}.pdf`;
      doc.save(fileName);
      
      if (exportCounter.get(chainId) === 2) {
        showExportLimitReachedModal(chainId, true);
      } else {
        showNotification(`✅ Wallet exportada (${exportCounter.get(chainId)}/2)`, 'success');
      }
    }
    
    function generateOfficialWalletBackupPDF(chainId) {
      exportWalletToPDF(chainId);
    }
    
    function restoreWallet(chainId) {
      showRestoreModal(chainId);
    }
    
    function updateGlobalWalletValue() {
      let totalUSD = 0;
      
      Object.keys(blockchainBalances).forEach(chainId => {
        const balance = blockchainBalances[chainId];
        if (balance && balance.usd) {
          totalUSD += parseFloat(balance.usd);
        }
      });
      
      const globalValueElement = document.getElementById('globalWalletValue');
      if (globalValueElement) {
        globalValueElement.textContent = `$${totalUSD.toLocaleString('en-US', {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2
        })} USD`;
      }
      
      globalWalletValue = totalUSD;
    }
    
    function initializeBlockchainButtons() {
      const container = document.getElementById('blockchainButtonsContainer');
      container.innerHTML = '';
      
      blockchains.forEach(chain => {
        const button = document.createElement('button');
        button.className = 'blockchain-button';
        button.dataset.chain = chain.id;
        button.innerHTML = chain.name;
        
        if (blockchainStorage.exists(chain.id)) {
          button.innerHTML += ' <i class="fas fa-check" style="margin-left:5px;font-size:10px;"></i>';
        }
        
        button.onclick = () => selectBlockchain(chain.id);
        container.appendChild(button);
      });
    }
    
    function initializeThemeToggle() {
      const themeToggle = document.getElementById('themeToggle');
      if (themeToggle) {
        themeToggle.addEventListener('click', () => {
          const body = document.body;
          const isLuxury = body.classList.contains('theme-luxury');
          
          if (isLuxury) {
            body.classList.remove('theme-luxury');
            body.classList.add('theme-light');
            themeToggle.innerHTML = '<i class="fas fa-moon"></i> Modo Escuro';
            showNotification('🌙 Modo claro ativado', 'info');
          } else {
            body.classList.remove('theme-light');
            body.classList.add('theme-luxury');
            themeToggle.innerHTML = '<i class="fas fa-sun"></i> Modo Claro';
            showNotification('☀️ Modo escuro ativado', 'info');
          }
        });
      }
    }
    
    function initializeTabs() {
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.addEventListener('click', function() {
          const tabId = this.dataset.tab;
          
          // Verificar se é a aba de Comunicação
          if (tabId === 'communicationTab') {
            window.location.href = 'communication.html';
            return;
          }
          
          document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          
          this.classList.add('active');
          document.getElementById(tabId).classList.add('active');
          
          if (tabId === 'soundExclusiveTab') {
            initializeSoundExclusive();
          } else if (tabId === 'agendaTab') {
            initializeAgenda();
          }
        });
      });
    }
    
    // CARREGAR TOKENS E NFTS SALVOS
    function loadSavedTokensAndNFTs() {
      blockchains.forEach(chain => {
        const savedTokens = localStorage.getItem(`tokens_${chain.id}`);
        if (savedTokens) {
          addedTokens[chain.id] = JSON.parse(savedTokens);
        }
        
        const savedNFTs = localStorage.getItem(`nfts_${chain.id}`);
        if (savedNFTs) {
          addedNFTs[chain.id] = JSON.parse(savedNFTs);
        }
      });
    }
    
    // ATUALIZAR INFORMAÇÕES DO RODAPÉ
    function updateSystemInfo() {
      // Calcular armazenamento usado
      let totalBytes = 0;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        const value = localStorage.getItem(key);
        totalBytes += key.length + (value ? value.length : 0);
      }
      const storageKB = (totalBytes / 1024).toFixed(1);
      
      // Atualizar elementos
      const storageElement = document.getElementById('storageStatus');
      const lastSyncElement = document.getElementById('lastSync');
      
      if (storageElement) {
        storageElement.textContent = `armazenamento: ${storageKB}KB`;
      }
      
      if (lastSyncElement) {
        const now = new Date();
        const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        lastSyncElement.textContent = `última sincronização: ${timeString}`;
      }
    }
    
    // INICIALIZAÇÃO
    document.addEventListener('DOMContentLoaded', () => {
      initializeBlockchainButtons();
      initializeThemeToggle();
      initializeTabs();
      loadSavedTokensAndNFTs();
      initializeSoundExclusive();
      initializeAgenda();
      
      // Atualizar informações do sistema periodicamente
      updateSystemInfo();
      setInterval(updateSystemInfo, 30000);
      
      // Mostrar notificação inicial
      setTimeout(() => {
        showNotification('✅ Sistema Blockchain Isolado inicializado com sucesso!', 'success');
      }, 1000);
    });
  </script>
</body>
</html>
